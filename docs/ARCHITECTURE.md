# Windows Maintenance Automation - Modular Architecture Design

## Project Overview
A completely restructured Windows maintenance system with modular architecture, interactive execution modes, and comprehensive reporting.

## Directory Structure
```
script_mentenanta/
â”œâ”€â”€ script.bat                     # Enhanced launcher with self-discovery
â”œâ”€â”€ MaintenanceOrchestrator.ps1    # Central coordination script
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ type1/                     # Type 1: Inventory & Reporting Modules
â”‚   â”‚   â”œâ”€â”€ SystemInventory.psm1   # System information collection
â”‚   â”‚   â”œâ”€â”€ BloatwareDetection.psm1 # Bloatware identification
â”‚   â”‚   â”œâ”€â”€ AppInventory.psm1      # Application discovery
â”‚   â”‚   â”œâ”€â”€ SecurityAudit.psm1     # Security posture analysis
â”‚   â”‚   â””â”€â”€ ReportGeneration.psm1  # HTML/Log report generation
â”‚   â”œâ”€â”€ type2/                     # Type 2: System Modification Modules
â”‚   â”‚   â”œâ”€â”€ BloatwareRemoval.psm1  # Application removal
â”‚   â”‚   â”œâ”€â”€ EssentialApps.psm1     # Application installation
â”‚   â”‚   â”œâ”€â”€ WindowsUpdates.psm1    # Update management
â”‚   â”‚   â”œâ”€â”€ TelemetryDisable.psm1  # Privacy optimization
â”‚   â”‚   â””â”€â”€ SystemOptimization.psm1 # Performance tuning
â”‚   â””â”€â”€ core/                      # Core Infrastructure Modules
â”‚       â”œâ”€â”€ DependencyManager.psm1 # Dependency installation
â”‚       â”œâ”€â”€ TaskScheduler.psm1     # Scheduled task management
â”‚       â”œâ”€â”€ ConfigManager.psm1     # Configuration handling
â”‚       â””â”€â”€ MenuSystem.psm1        # Interactive menu system
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ bloatware-lists/           # Bloatware definitions by category
â”‚   â”‚   â”œâ”€â”€ oem-bloatware.json
â”‚   â”‚   â”œâ”€â”€ windows-bloatware.json
â”‚   â”‚   â”œâ”€â”€ gaming-bloatware.json
â”‚   â”‚   â””â”€â”€ security-bloatware.json
â”‚   â”œâ”€â”€ essential-apps/            # Essential app definitions by category
â”‚   â”‚   â”œâ”€â”€ web-browsers.json
â”‚   â”‚   â”œâ”€â”€ productivity.json
â”‚   â”‚   â”œâ”€â”€ media.json
â”‚   â”‚   â””â”€â”€ development.json
â”‚   â”œâ”€â”€ main-config.json           # Main configuration file
â”‚   â””â”€â”€ logging-config.json        # Logging configuration
â”œâ”€â”€ temp_files/                    # Runtime temporary files
â”‚   â”œâ”€â”€ inventory/                 # System inventory cache
â”‚   â”œâ”€â”€ reports/                   # Generated reports
â”‚   â””â”€â”€ logs/                      # Detailed operation logs
â””â”€â”€ docs/
    â”œâ”€â”€ README.md                  # Project documentation
    â”œâ”€â”€ ARCHITECTURE-DIAGRAM.md    # Visual architecture diagrams
    â””â”€â”€ MODULE-GUIDE.md            # Module development guide
```

## Visual Architecture
ðŸ“Š **See [ARCHITECTURE-DIAGRAM.md](docs/ARCHITECTURE-DIAGRAM.md) for detailed visual diagrams including:**
- Complete system architecture flow
- Module interaction sequences  
- Configuration management flow
- Dependency bootstrap process

## Module Architecture

### Type 1 Modules (Inventory & Reporting)
- **Purpose**: Collect information, analyze system state, generate reports
- **Characteristics**: 
  - Read-only operations
  - Return structured data objects
  - Can run independently
  - Create temporary files and reports
- **Current Modules**:
  - `SystemInventory.psm1` - Comprehensive system information collection
  - `BloatwareDetection.psm1` - Scan for unwanted applications and components
  - `SecurityAudit.psm1` - Security posture analysis with scoring system
  - `ReportGeneration.psm1` - HTML and text report generation
  - Cacheable results for performance

### Type 2 Modules (System Modification)
- **Purpose**: Modify system state, install/remove software, change settings
- **Characteristics**:
  - Write operations that change the system
  - Return success/failure booleans for orchestrator tracking
  - Can trigger Type 1 modules for pre/post analysis
  - Require elevated privileges for most operations
  - Must support dry-run mode via `-DryRun` parameter
  - Generate before/after comparisons
- **Current Modules**:
  - `BloatwareRemoval.psm1` - Remove unwanted applications using multiple methods
  - `EssentialApps.psm1` - Install curated essential software collections
  - `WindowsUpdates.psm1` - Windows Update management with suppression handling
  - `TelemetryDisable.psm1` - Privacy hardening and telemetry disabling
  - `SystemOptimization.psm1` - Performance tuning, cleanup, and optimization

### Core Infrastructure Modules
- **Purpose**: Provide foundational services for the maintenance system
- **Characteristics**:
  - Support both Type 1 and Type 2 modules
  - Handle configuration, dependencies, scheduling, and user interaction
  - Load first during orchestrator initialization
- **Current Modules**:
  - `ConfigManager.psm1` - JSON configuration loading, validation, and management
  - `MenuSystem.psm1` - Interactive countdown menus with automatic fallbacks
  - `DependencyManager.psm1` - Package manager installation and dependency resolution
  - `TaskScheduler.psm1` - Windows scheduled task creation and management

## Execution Flow

### Interactive Menu System (20-second countdowns)
```
Main Menu (20s countdown)
â”œâ”€â”€ Option 1: Execute Maintenance (Unattended) [DEFAULT]
â”‚   â”œâ”€â”€ Sub-Option 1: Execute All Tasks [DEFAULT after 20s]
â”‚   â””â”€â”€ Sub-Option 2: Execute Specific Task Numbers (20s countdown)
â””â”€â”€ Option 2: Execute with Dry-Run Mode
    â”œâ”€â”€ Sub-Option 1: Dry-Run All Tasks [DEFAULT after 20s]
    â””â”€â”€ Sub-Option 2: Dry-Run Specific Task Numbers (20s countdown)
```

### Task Selection Examples
```
Enter task numbers (comma-separated): 1,3,5,7
Available tasks:
1. System Inventory
2. Bloatware Removal  
3. Essential Apps Installation
4. Windows Updates
5. Telemetry Disable
6. System Optimization
```

## Configuration System

### Main Configuration Structure
```json
{
  "execution": {
    "defaultMode": "unattended",
    "countdownSeconds": 20,
    "enableDryRun": true
  },
  "modules": {
    "skipBloatwareRemoval": false,
    "skipEssentialApps": false,
    "skipWindowsUpdates": false,
    "customModulesPath": ""
  },
  "logging": {
    "enableHtmlReport": true,
    "logLevel": "INFO",
    "maxLogSizeMB": 10
  }
}
```

### Modular Configuration Files
- **bloatware-lists/*.json**: Separated by category for easy maintenance
- **essential-apps/*.json**: Organized by application type
- **main-config.json**: Central execution parameters
- **logging-config.json**: Logging behavior configuration

## Reporting System

### Maintenance Log (maintenance.log)
- Single comprehensive log file
- Structured sections per module
- Standardized timestamp and level format

### HTML Report (maintenance-report.html)
- Interactive web-based report
- Collapsible sections per module
- Before/after comparisons
- Charts and visualizations
- Mobile-responsive design

## Self-Discovery Environment

### Enhanced script.bat Features
- **Path Independence**: Works from any folder on any PC
- **Auto-Discovery**: Detects PowerShell 7, dependencies, repo structure  
- **Intelligent Fallbacks**: Graceful degradation when components missing
- **Improved Logging**: Detailed diagnostic information
- **Module System**: Loads and validates module dependencies

## Benefits of New Architecture

1. **Modularity**: Each component has single responsibility
2. **Maintainability**: Easy to update bloatware/app lists separately
3. **Flexibility**: Can run individual modules or full suites
4. **Performance**: Cached Type 1 modules, parallel Type 2 execution
5. **Usability**: Interactive menus with sane defaults
6. **Reporting**: Comprehensive HTML and text reports
7. **Portability**: Self-contained with discovery capabilities