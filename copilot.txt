# ğŸš€ PowerShell Maintenance Project - Complete Overhaul Guide
## VSCode Copilot Comprehensive Analysis & Implementation Prompt

---

## ğŸ“‹ Table of Contents

1. [Project Overview](#project-overview)
2. [Critical Analysis Requirements](#critical-analysis-requirements)
3. [Architecture & Execution Flow](#architecture--execution-flow)
4. [Module Analysis Framework](#module-analysis-framework)
5. [Implementation Requirements](#implementation-requirements)
6. [Quality Assurance Checklist](#quality-assurance-checklist)
7. [Copilot Command Reference](#copilot-command-reference)

---

## ğŸ¯ Project Overview

### Primary Objective
Create an enterprise-grade, unattended Windows 10/11 maintenance automation system that can run monthly via Task Scheduler from any network location.

### Execution Environment
- **Target Systems**: Windows 10/11 workstations
- **Execution Trigger**: Monthly via Task Scheduler
- **Autonomy Level**: Fully unattended with optional user intervention

### Core Workflow
```
script.bat â†’ Download latest repo from GitHub â†’ Extract â†’ Execute project â†’ 
Generate HTML report â†’ Cleanup â†’ System reboot (with countdown option)
```

---

## ğŸ” Critical Analysis Requirements

### Phase 1: Comprehensive Module Analysis

**Primary Copilot Prompt:**
```
@workspace Perform deep analysis of the PowerShell Maintenance Project:

ARCHITECTURE REVIEW:
1. Analyze /core folder structure and dependencies
2. Analyze /config folder - configuration files, format validation, error handling
3. Map all Type1 modules (system inventory gatherers)
4. Map all Type2 modules (maintenance action executors)
5. Document MaintenanceOrchestrator.ps1 execution flow
6. Identify script.bat â†’ orchestrator â†’ module chain
7. Create complete dependency graph showing all module relationships

MODULE CLASSIFICATION:
For each module, determine:
- Type 1 (Inventory/Data Collection) or Type 2 (Action/Maintenance)
- OS-specific requirements (Windows 10 vs 11 compatibility)
- Required system tools and paths (must be OS-aware)
- Input dependencies from other modules
- Output file locations and formats
- Error handling completeness
- Logging implementation quality

CROSS-MODULE DATA FLOW:
1. Trace how Type1 modules collect system inventory
2. Verify Type1 output files are created in /temp_files
3. Trace how Type2 modules consume Type1 inventory data
4. Identify data transformation or loss points
5. Verify log processing determines Type2 actions
6. Document which Type2 modules should skip if no actions needed

Provide detailed findings with:
- Module name and type
- Current implementation analysis
- Logic errors or edge cases
- Missing error handling
- Integration issues
- Optimization opportunities
- Code examples for critical issues
```

### Phase 2: Logic and Optimization Review

**Copilot Prompt:**
```
@workspace Find critical logic flaws and optimization opportunities:

CRITICAL ISSUES (Fix First):
1. Null references without guards
2. Empty catch blocks with no logging
3. Infinite loops or recursion without exit
4. Missing error handling on system-modifying operations
5. Hardcoded paths that break network deployment
6. Variables assigned but never used
7. Functions defined but never called
8. Incomplete if/else branches
9. Type mismatches in parameter passing
10. Resource leaks (file handles, connections)

PERFORMANCE BOTTLENECKS:
1. Nested loops with high complexity
2. Repeated expensive operations (registry, WMI, file I/O)
3. Inefficient PowerShell pipelines
4. Unnecessary file reads/writes
5. Missing parallel execution opportunities
6. Redundant data collection
7. Memory-intensive operations without cleanup

OS COMPATIBILITY:
1. Windows 10 vs 11 specific paths
2. Different tool locations (system32, syswow64)
3. PowerShell version requirements
4. .NET Framework dependencies
5. WMI vs CIM cmdlet usage
6. Registry key differences

For each issue found:
- Module name and line number
- Severity: Critical/High/Medium/Low
- Current problematic code
- Recommended fix with code example
- Impact if not fixed
```

### Phase 3: Code Quality and Duplication

**Copilot Prompt:**
```
@workspace Identify code duplication and quality issues:

DUPLICATE CODE ANALYSIS:
1. Find identical or near-identical functions across modules
2. Identify repeated code blocks (3+ lines appearing 2+ times)
3. Locate similar patterns that could be abstracted
4. Show where helper functions should be created
5. Suggest proper placement in /core for shared utilities

REFACTORING OPPORTUNITIES:
For each duplicate:
- Show all locations where code appears
- Propose unified function signature
- Suggest module placement (/core/utilities.ps1?)
- Provide before/after refactoring example
- List all modules that would benefit

CODE QUALITY ISSUES:
1. Functions without help documentation
2. Missing parameter validation
3. No ShouldProcess on destructive operations
4. Inconsistent error handling patterns
5. Magic numbers without constants
6. Unclear variable names
7. Functions doing too many things
8. Missing output types

Provide refactoring plan with migration steps.
```

### Phase 4: Logging and Reporting Infrastructure

**Copilot Prompt:**
```
@workspace Analyze logging and reporting implementation:

LOGGING REQUIREMENTS:
The maintenance.log must be a PowerShell transcript for the ENTIRE project execution.

Current State Analysis:
1. When is maintenance.log created?
2. Is Start-Transcript called at project start?
3. Is Stop-Transcript called before cleanup?
4. Where is the log file stored during execution?
5. Is it moved to /temp_files/logs by LogProcessor?
6. What modules write to the log?
7. Is everything logged (every decision, action, error)?

Logging Completeness Check:
For EVERY module verify logging of:
- Module start/end timestamps
- Input parameters received
- Decisions made (if/else branches taken)
- Actions performed vs skipped
- Files created/modified/deleted
- Errors and warnings
- Performance metrics (duration)
- Success/failure status

HTML REPORT GENERATION:
Verify report includes:
1. Executive summary of entire project run
2. Individual module sections with:
   - Module name and purpose
   - Actions taken vs skipped
   - Files affected
   - Errors encountered
   - Performance metrics
3. System inventory summary (from Type1)
4. Maintenance actions summary (from Type2)
5. Timestamp and system information
6. Color-coded status indicators

Report Placement:
- Must be copied to script.bat location (relative path)
- Must work from any network location
- Must handle special characters in paths

Identify gaps and provide implementation plan.
```

---

## ğŸ—ï¸ Architecture & Execution Flow

### Target Execution Sequence

**Copilot Prompt for Flow Verification:**
```
@workspace Verify and document the complete execution flow:

STAGE 0 - INITIALIZATION:
1. script.bat execution from network location
2. GitHub repo download to temp location
3. Extraction to local folder
4. Environment detection (OS version, PowerShell version, .NET)
5. /temp_files folder creation in extracted repo
6. maintenance.log creation with Start-Transcript

STAGE 1 - SYSTEM INVENTORY (Type1 Modules):
Display interactive menu:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STAGE 1: SYSTEM INVENTORY               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 - Run All Type1 Modules (Default)    â”‚
â”‚ 1 - [Type1 Module 1 Name]               â”‚
â”‚ 2 - [Type1 Module 2 Name]               â”‚
â”‚ 3 - [Type1 Module 3 Name]               â”‚
â”‚ ...                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Auto-executing option 0 in 10 seconds...â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Input Handling:
- Wait 10 seconds for input
- If no input: Execute option 0 (all modules)
- If valid number: Execute specific module
- If invalid: Show error, re-prompt

Type1 Execution Requirements:
- Each module runs OS-specific checks FIRST
- Creates inventory file in /temp_files/[ModuleName]/
- Logs all findings to maintenance.log
- Handles errors gracefully (no crash, log and continue)
- Reports completion status

STAGE 2 - LOG PROCESSING:
1. LogProcessor analyzes Type1 output files
2. Determines which Type2 modules have work to do
3. Creates action plans for each Type2 module
4. Logs decision rationale

STAGE 3 - MAINTENANCE ACTIONS (Type2 Modules):
For each Type2 module:
- Check if action plan exists
- If no actions needed: Log "No actions required" and SKIP
- If actions needed: Execute module
- Log all actions taken
- Update temp files with results
- Handle errors with rollback if possible

STAGE 4 - REPORT GENERATION:
1. Aggregate all Type1 inventory data
2. Aggregate all Type2 action results
3. Process maintenance.log transcript
4. Generate comprehensive HTML report
5. Copy report to script.bat location

STAGE 5 - CLEANUP & REBOOT:
Display countdown:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SYSTEM REBOOT COUNTDOWN                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ All tasks completed successfully.       â”‚
â”‚ HTML report saved to:                   â”‚
â”‚ [script.bat location]\report.html       â”‚
â”‚                                         â”‚
â”‚ System will reboot in: 120 seconds      â”‚
â”‚                                         â”‚
â”‚ Press ANY KEY to abort reboot and       â”‚
â”‚ keep temporary files for review.        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Countdown Handling:
- Count down from 120 to 0
- Update display each second
- Monitor for ANY keypress
- If key pressed: Abort, display "Cleanup aborted", exit
- If countdown completes: Delete repo folder, Restart-Computer

Trace current implementation against this flow.
Identify missing components.
Provide implementation roadmap.
```

---

## ğŸ“¦ Module Analysis Framework

### Type1 Module Analysis Template

**Copilot Prompt:**
```
@workspace Analyze Type1 module: [ModuleName]

MODULE IDENTIFICATION:
- File path: 
- Current classification (Type1/Type2):
- Should be Type1? (Inventory/Data collection):

FUNCTIONALITY ANALYSIS:
1. What system information does it collect?
2. What Windows versions does it support?
3. What system tools/commands does it use?
4. Are paths OS-aware (Win10 vs Win11)?
5. Can it run independently?
6. Does it require admin rights?

DATA OUTPUT:
1. What files does it create in /temp_files?
2. What format (JSON, CSV, TXT, XML)?
3. Is output structured for Type2 consumption?
4. What information is captured?
5. Are errors logged to maintenance.log?

OS-SPECIFIC IMPLEMENTATION:
1. Does it detect OS version FIRST?
2. Are paths dynamic or hardcoded?
3. Does it handle missing tools gracefully?
4. Are registry paths version-aware?
5. Does it use WMI or CIM appropriately?

ERROR HANDLING:
1. Try-catch coverage:
2. Logging of all errors:
3. Graceful degradation if tools missing:
4. User-friendly error messages:

INTEGRATION POINTS:
1. Called by orchestrator?
2. Dependencies on other modules:
3. Which Type2 modules consume its output:
4. Data transformation needs:

IMPROVEMENT OPPORTUNITIES:
1. Logic errors:
2. Missing error handling:
3. Performance optimization:
4. Code duplication:
5. Documentation gaps:

Provide detailed report with code examples.
```

### Type2 Module Analysis Template

**Copilot Prompt:**
```
@workspace Analyze Type2 module: [ModuleName]

MODULE IDENTIFICATION:
- File path:
- Current classification (Type1/Type2):
- Should be Type2? (Action/Maintenance):

FUNCTIONALITY ANALYSIS:
1. What maintenance actions does it perform?
2. What Type1 data does it require?
3. What system changes does it make?
4. Are actions OS-specific (Win10 vs Win11)?
5. Does it support -WhatIf (dry-run)?
6. Does it require admin rights?

DATA INPUT:
1. Which Type1 modules provide required data?
2. What files does it read from /temp_files?
3. How does it parse input data?
4. What happens if input is missing/corrupt?
5. Does it validate data before acting?

ACTION LOGIC:
1. How does it determine what actions to take?
2. Does it skip if no actions needed?
3. Does it log "No actions required"?
4. What criteria trigger each action?
5. Are actions idempotent (safe to re-run)?

OS-SPECIFIC IMPLEMENTATION:
1. Does it detect OS version before acting?
2. Are tool paths OS-aware?
3. Does it handle OS differences properly?
4. Are registry modifications version-aware?

ERROR HANDLING:
1. Try-catch coverage on system modifications:
2. Rollback capability if actions fail:
3. Logging of all actions and errors:
4. Graceful failure without breaking project:


INTEGRATION POINTS:
1. Called by orchestrator after log processing?
2. Action plan provided by LogProcessor?
3. Output files created in /temp_files?
4. Report data generated for HTML report?

IMPROVEMENT OPPORTUNITIES:
1. Logic errors or edge cases:
2. Missing error handling or rollback:
3. Performance optimization:
4. Safety improvements:
5. Documentation gaps:

Provide detailed report with code examples.
```

---

## ğŸ¯ Implementation Requirements

### Feature 1: Enhanced HTML Reporting

**Copilot Prompt:**
```
@workspace Implement comprehensive HTML report generation:

REQUIREMENTS:
Create professional HTML report with:

1. EXECUTIVE SUMMARY SECTION:
   - Project name and version
   - Execution timestamp (start and end)
   - System information (hostname, OS, user)
   - Overall status (Success/Warnings/Errors)
   - Total duration
   - Summary metrics:
     * Type1 modules executed
     * Type2 modules executed
     * Actions performed
     * Files modified
     * Errors encountered

2. TYPE1 INVENTORY SECTION:
   For each Type1 module executed:
   - Collapsible card/box with module name
   - Module description and purpose
   - Inventory data collected (table format)
   - Files created
   - Execution time
   - Status indicator (âœ“ Success / âš  Warning / âœ— Error)

3. TYPE2 MAINTENANCE SECTION:
   For each Type2 module executed:
   - Collapsible card/box with module name
   - Module description and purpose
   - Actions taken (bullet list with details)
   - Files modified
   - Success/skip/error counts
   - Execution time
   - Status indicator

4. DETAILED LOG SECTION:
   - Collapsible full transcript
   - Syntax-highlighted PowerShell output
   - Filterable by module, severity, keyword
   - Timestamp for each entry

5. STYLING REQUIREMENTS:
   - Responsive design (mobile-friendly)
   - Professional color scheme (blues/greens for success, yellows for warnings, reds for errors)
   - Bootstrap or similar framework
   - Printable version
   - No external dependencies (all CSS/JS inline)

6. REPORT PLACEMENT:
   - Save to /temp_files/MaintenanceReport_[timestamp].html
   - Copy to script.bat location using relative path
   - Handle UNC network paths correctly
   - Create fallback if copy fails

Provide complete implementation code.
Show integration with MaintenanceOrchestrator.ps1.
Include example HTML output.
```

### Feature 2: Interactive Stage 1 Menu

**Copilot Prompt:**
```
@workspace Implement interactive Type1 module selection menu:

REQUIREMENTS:

1. MENU DISPLAY:
   - Clear header "STAGE 1: SYSTEM INVENTORY"
   - Option 0: "Run All Type1 Modules (Default)"
   - Numbered list of all Type1 modules with names
   - Footer with 10-second countdown

2. USER INPUT HANDLING:
   ```powershell
   # Countdown from 10 to 0
   # Display: "Auto-executing option 0 in X seconds..."
   # Monitor for numeric input
   # If valid number entered: Execute that module
   # If 0 or timeout: Execute all Type1 modules
   # If invalid: Show error, re-display menu
   ```

3. EXECUTION LOGIC:
   - Dynamic module discovery from /type1 folder
   - Load each module
   - Execute selected option(s)
   - Log all actions
   - Handle errors gracefully
   - Display progress for each module

4. VISUAL FEEDBACK:
   - Clear screen before menu
   - Use colors (Write-Host with -ForegroundColor)
   - Progress indicators during execution
   - Success/failure status after each module

Provide complete implementation code.
Show integration point in MaintenanceOrchestrator.ps1.
```

### Feature 3: Cleanup Countdown with Abort

**Copilot Prompt:**
```
@workspace Implement cleanup countdown with abort functionality:

REQUIREMENTS:

1. COUNTDOWN DISPLAY:
   ```
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ MAINTENANCE COMPLETE                    â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ HTML Report: [path]                     â”‚
   â”‚                                         â”‚
   â”‚ System will reboot in: XXX seconds      â”‚
   â”‚                                         â”‚
   â”‚ Press ANY KEY to abort reboot           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   ```

2. COUNTDOWN LOGIC:
   - Start at 120 seconds
   - Update display every second
   - Monitor for keyboard input using [Console]::KeyAvailable
   - Countdown shows: "120... 119... 118..." with visual update

3. ABORT HANDLING:
   - If ANY key pressed during countdown:
     * Immediately stop countdown
     * Display "Reboot aborted by user"
     * Display "Temporary files preserved at: [path]"
     * Display "HTML report saved at: [path]"
     * Exit with code 0 (no reboot)
   
4. TIMEOUT HANDLING:
   - If countdown reaches 0 with no input:
     * Display "Cleaning up temporary files..."
     * Remove extracted repo folder
     * Verify deletion success
     * Display "Initiating system reboot..."
     * Execute: Restart-Computer -Force
     * Exit with code 0

5. ERROR HANDLING:
   - If cleanup fails: Log error, skip reboot, exit
   - If reboot fails: Log error, exit with code 1
   - All errors logged to maintenance.log

Provide complete implementation code.
Show integration as final stage in MaintenanceOrchestrator.ps1.
Include testing scenarios.
```

### Feature 4: Comprehensive Transcript Logging

**Copilot Prompt:**
```
@workspace Implement comprehensive transcript logging:

REQUIREMENTS:

1. TRANSCRIPT INITIALIZATION:
   ```powershell
   # At very start of MaintenanceOrchestrator.ps1
   # Create /temp_files/logs/ directory
   # Start-Transcript -Path "/temp_files/logs/maintenance.log"
   # Log: Project name, version, timestamp, system info
   ```

2. MODULE LOGGING REQUIREMENTS:
   Every module must log:
   - Module start with timestamp
   - Input parameters or data sources
   - Every decision point (if/else branches taken)
   - Every action performed
   - Every file created/modified/deleted
   - Every error or warning
   - Module end with duration and status

3. LOGGING STANDARDS:
   - Prefix format: "[TIMESTAMP] [MODULE] [LEVEL] Message"
   - Levels: INFO, WARNING, ERROR, DEBUG
   - Use Write-Host for console + transcript
   - Never use Write-Output (breaks transcript)
   - All exceptions must be logged with stack trace

4. ORCHESTRATOR LOGGING:
   - Stage transitions
   - Module execution order
   - Data flow between modules
   - Performance metrics
   - Overall project status

5. TRANSCRIPT FINALIZATION:
   ```powershell
   # Before report generation
   # Log: Project completion summary
   # Stop-Transcript
   # Verify log file exists and is readable
   # Include log in HTML report generation
   ```

Provide implementation examples for:
- Orchestrator initialization
- Type1 module logging template
- Type2 module logging template
- Error logging best practices
```

---

## âœ… Quality Assurance Checklist

### Pre-Deployment Validation

**Copilot Prompt:**
```
@workspace Perform comprehensive pre-deployment validation:

CRITICAL CHECKS:
[ ] All PSScriptAnalyzer Critical/Warning issues resolved
[ ] No empty catch blocks anywhere in project
[ ] No null reference errors possible
[ ] All hardcoded paths replaced with dynamic discovery
[ ] All Type1 modules create output in /temp_files
[ ] All Type2 modules handle missing input gracefully
[ ] MaintenanceOrchestrator.ps1 imports all modules
[ ] Start-Transcript at project start
[ ] Stop-Transcript before report generation
[ ] HTML report generation tested and verified
[ ] Report copy to script.bat location works
[ ] Countdown abort functionality tested
[ ] Cleanup and reboot tested (in VM)

FUNCTIONALITY CHECKS:
[ ] Can execute from any folder path
[ ] Can execute from UNC network path
[ ] Works on Windows 10 (multiple versions)
[ ] Works on Windows 11
[ ] Works with non-admin rights (where possible)
[ ] Works with admin rights
[ ] Dry-run mode works (WhatIf)
[ ] No system modifications in WhatIf mode

INTEGRATION CHECKS:
[ ] script.bat downloads repo successfully
[ ] Extraction to temp folder works
[ ] All modules discovered and loaded
[ ] Type1 menu displays correctly
[ ] Type1 modules execute independently
[ ] LogProcessor analyzes Type1 output
[ ] Type2 modules receive correct data
[ ] Type2 modules skip if no actions needed
[ ] Report includes all module data
[ ] Cleanup removes only repo folder

ERROR HANDLING CHECKS:
[ ] Network failure during download handled
[ ] Extraction failure handled
[ ] Missing module files handled
[ ] Corrupt Type1 output handled
[ ] Type2 execution errors don't crash project
[ ] Report generation failure handled
[ ] Cleanup failure handled gracefully

DOCUMENTATION CHECKS:
[ ] README.md complete and accurate
[ ] Each module has header comment block
[ ] All functions have help documentation
[ ] Installation instructions verified
[ ] Task Scheduler setup documented
[ ] Troubleshooting guide created

PERFORMANCE CHECKS:
[ ] Total execution time < 30 minutes
[ ] No memory leaks detected
[ ] No runaway processes
[ ] Temp file cleanup complete
[ ] Log file size reasonable (< 50MB)

Generate validation report with pass/fail for each item.
Include remediation steps for failures.
```

---

## ğŸ“š Copilot Command Reference

### Quick Diagnostic Commands

#### Critical Issues Scan
```
@workspace Emergency scan for project-breaking issues:
1. Find all null references without validation
2. Find all empty catch blocks
3. Find all hardcoded paths
4. Find all infinite loop risks
5. Find all missing error handlers on system modifications
Show with file paths and line numbers, grouped by severity.
```

#### Module Discovery
```
@workspace Inventory all modules in project:
1. List all .ps1 files in /type1
2. List all .ps1 files in /type2
3. List all .ps1 files in /core
4. For each file, determine:
   - Module type (Type1/Type2/Core)
   - Primary function
   - Dependencies
   - Integration with orchestrator
Create dependency graph.
```

#### Data Flow Trace
```
@workspace Trace complete data flow:
1. Map Type1 output files â†’ storage location â†’ format
2. Map LogProcessor input files â†’ processing logic â†’ output
3. Map Type2 input requirements â†’ source files â†’ processing
4. Identify all transformation points
5. Find data loss or corruption risks
Create visual flow diagram.
```

### Module-Specific Analysis

#### Single Module Deep Dive
```
@workspace Complete analysis of [ModuleName.ps1]:
1. Function-by-function breakdown
2. Parameter validation review
3. Error handling audit
4. Logic error identification
5. Performance bottlenecks
6. Integration verification
7. Documentation completeness
8. Recommended improvements
Provide detailed report with code examples.
```

#### Cross-Module Comparison
```
@workspace Compare error handling across all modules:
1. Find inconsistent patterns
2. Identify best practice examples
3. Find modules missing error handling
4. Suggest standardized template
5. Provide refactoring plan
Show before/after code examples.
```

### Code Quality Improvement

#### Duplicate Code Elimination
```
@workspace Find and eliminate duplicate code:
1. Scan all modules for duplicate functions (90%+ similarity)
2. Scan for repeated code blocks (5+ lines, 2+ occurrences)
3. Identify candidates for utility functions
4. Suggest placement in /core
5. Provide refactoring steps with examples
Show impact analysis (lines saved, modules affected).
```

#### Performance Optimization
```
@workspace Identify performance improvements:
1. Find nested loops (O(nÂ²) or worse)
2. Find repeated expensive operations (WMI, registry, file I/O)
3. Find inefficient pipelines
4. Suggest parallel execution opportunities
5. Identify unnecessary data collection
Provide optimized code examples with before/after benchmarks.
```

### Testing and Validation

#### Generate Test Cases
```
@workspace Create Pester test suite for [ModuleName]:
1. Test valid inputs for all functions
2. Test invalid inputs (null, empty, wrong type)
3. Test edge cases (max values, special characters)
4. Test error conditions
5. Test integration with dependent modules
Provide complete .Tests.ps1 file.
```

#### End-to-End Test Plan
```
@workspace Create complete test plan:
1. Pre-test setup steps
2. Test folder preparation
3. script.bat execution test
4. Module-by-module validation
5. Report verification
6. Cleanup verification
7. Expected outcomes for each step
8. Pass/fail criteria
Provide test checklist and validation script.
```

### Documentation Generation

#### Create README.md
```
@workspace Generate comprehensive README.md:
1. Project overview and purpose
2. System requirements
3. Installation steps
4. Task Scheduler configuration
5. Module descriptions (Type1 and Type2)
6. Execution flow diagram
7. Troubleshooting guide
8. FAQ section
9. Contribution guidelines
Use clear formatting with examples.
```

#### Generate Module Documentation
```
@workspace Create documentation for all modules:
For each module generate:
1. Module purpose and description
2. Function reference with parameters
3. Input requirements
4. Output format
5. Dependencies
6. Examples
7. Error handling behavior
Create individual .md files in /docs folder.
```

---

## ğŸ¯ Phased Implementation Plan

### Phase 1: Critical Fixes (Week 1)

**Copilot Prompt:**
```
@workspace Phase 1 implementation - Critical fixes:

TASKS:
1. Fix all null reference errors
2. Add error handling to empty catch blocks
3. Replace all hardcoded paths with dynamic discovery
4. Fix incomplete if/else statements
5. Add missing parameter validation
6. Fix OS compatibility issues (Win10 vs Win11)

For each task:
- Identify all instances
- Provide fixes with code
- Test scenarios
- Verification steps

Generate implementation checklist.
```

### Phase 2: Architecture Improvements (Week 2)

**Copilot Prompt:**
```
@workspace Phase 2 implementation - Architecture:

TASKS:
1. Implement /temp_files creation in repo folder
2. Add Start-Transcript to orchestrator
3. Implement Type1 module menu with countdown
4. Implement LogProcessor for Type1 output analysis
5. Add Type2 skip logic for no-action scenarios
6. Add Stop-Transcript before report generation

Provide:
- Implementation code for each task
- Integration points
- Testing procedures
```

### Phase 3: Reporting and Cleanup (Week 3)

**Copilot Prompt:**
```
@workspace Phase 3 implementation - Reporting:

TASKS:
1. Create HTML report generator
2. Add module-specific report sections
3. Implement report copy to script.bat location
4. Create 120-second countdown with abort
5. Implement cleanup logic (delete repo folder)
6. Add Restart-Computer with proper error handling

Provide:
- Complete implementation code
- HTML template
- Testing scenarios
- Error recovery procedures
```

### Phase 4: Testing and Documentation (Week 4)

**Copilot Prompt:**
```
@workspace Phase 4 implementation - Testing:

TASKS:
1. Create Pester test suite
2. Generate module documentation
3. Create README.md
4. Write troubleshooting guide
5. Perform end-to-end testing
6. Create deployment package

Provide:
- Test scripts
- Documentation files
- Deployment checklist
- Known issues list
```

---

## ğŸ”§ Project Structure Reference

```
PowerShell-Maintenance-Project/
â”œâ”€â”€ script.bat                          # Entry point (network-deployed)
â”œâ”€â”€ MaintenanceOrchestrator.ps1         # Main orchestrator
â”œâ”€â”€ README.md                           # Project documentation
â”œâ”€â”€ /core/                              # Core utilities and shared functions
â”‚   â”œâ”€â”€ Utilities.ps1
â”‚   â”œâ”€â”€ LogProcessor.ps1
â”‚   â”œâ”€â”€ ReportGenerator.ps1
â”‚   â””â”€â”€ ...
â”œâ”€â”€ /config/                            # Configuration files
â”‚   â”œâ”€â”€ settings.json
â”‚   â”œâ”€â”€ module-config.json
â”‚   â””â”€â”€ ...
â”œâ”€â”€ /type1/                             # Type1 modules (inventory)
â”‚   â”œâ”€â”€ Type1-Module1.ps1
â”‚   â”œâ”€â”€ Type1-Module2.ps1
â”‚   â””â”€â”€ ...
â”œâ”€â”€ /type2/                             # Type2 modules (maintenance actions)
â”‚   â”œâ”€â”€ Type2-Module1.ps1
â”‚   â”œâ”€â”€ Type2-Module2.ps1
â”‚   â””â”€â”€ ...
â”œâ”€â”€ /temp_files/                        # Runtime temp files (created during execution)
â”‚   â”œâ”€â”€ /logs/
â”‚   â”‚   â””â”€â”€ maintenance.log
â”‚   â”œâ”€â”€ /type1-output/
â”‚   â”‚   â””â”€â”€ [module-specific files]
â”‚   â”œâ”€â”€ /type2-output/
â”‚   â”‚   â””â”€â”€ [module-specific files]
â”‚   â””â”€â”€ /reports/
â”‚       â””â”€â”€ MaintenanceReport_[timestamp].html
â””â”€â”€ /tests/                             # Pester tests
    â”œâ”€â”€ Unit/
    â””â”€â”€ Integration/
```

---

## ğŸ“– Usage Instructions

### For Comprehensive Project Analysis
1. Open VSCode in your project folder
2. Open Copilot Chat (`Ctrl+Shift+I`)
3. Copy the entire **Phase 1: Comprehensive Module Analysis** prompt
4. Paste into Copilot Chat
5. Review findings and create action items

### For Specific Module Analysis
1. Navigate to the module file in VSCode
2. Open Copilot Chat
3. Use the **Type1 Module Analysis Template** or **Type2 Module Analysis Template**
4. Replace `[ModuleName]` with actual module name
5. Review detailed analysis

### For Implementation Tasks
1. Start with Phase 1 critical fixes
2. Use corresponding Copilot prompts from **Phased Implementation Plan**
3. Implement changes incrementally
4. Test after each phase
5. Document all changes

### For Quality Assurance
1. Use **Pre-Deployment Validation** checklist
2. Run through each check systematically
3. Address failures before proceeding
4. Generate final validation report

---

## ğŸš¨ Critical Reminders


2. **Maintain transcript logging** - Everything must be logged
3. **OS compatibility is mandatory** - Must work on Windows 10 and 11
4. **Network paths must work** - Script.bat can be anywhere
5. **Unattended operation is required** - Default behavior needs no user input
6. **Error handling is non-negotiable** - No crashes, only graceful degradation
7. **Cleanup must be reliable** - No orphaned files or processes
8. **Documentation must be current** - Update as you implement changes

---

## ğŸ“ Support and Feedback

### When Copilot Analysis is Unclear
```
@workspace Clarify previous analysis for [specific topic]:
Provide:
1. More detailed explanation
2. Concrete code examples
3. Step-by-step implementation
4. Testing scenarios
```

### When Implementation Fails
```
@workspace Debug implementation failure for [feature]:
Current code: [paste code]
Error: [paste error]
Expected behavior: [describe]

Provide:
1. Root cause analysis
2. Fixed code
3. Why original approach failed
4. Prevention for future
```

---

## âœ¨ Final Notes

This document is your comprehensive guide to overhauling the PowerShell Maintenance Project using VSCode Copilot. Use the prompts sequentially for best results, starting with critical analysis and moving through implementation phases.

Remember:
- **Be specific** with module names and file paths in prompts
- **Include context** by using `@workspace` for project-wide analysis
- **Iterate** - review Copilot's suggestions and refine prompts as needed
- **Test incrementally** - validate each change before moving forward
- **Document everything** - maintain records of changes and decisions

**Success Criteria:** A fully functional, unattended maintenance system that can run monthly on any Windows 10/11 PC with comprehensive logging and reporting.

---

how i like this project to run and what you should implement 
temp_files folder must be created in the extracted repo folder
maintenance.log should be like a powershell transcript for the entire project
when the orchestrator is running it should display a menu as fallows
Stage 1 gadder System Inventory 
   0 - run all Type1 modules
   1 - Type1 no 1
   2 - Type1 no 2
   3 - Type1 no 3
   ......
   with a 10 s countdown, if no user input (1, 2, 3 ....) 
   it should run 0 - run all Type1 modules and create inventory files for the respective module 
   Type1 and Type2 modules must run OS specific actions paths and tools
   These logs should be processed and determine what actions should be run by the Type2 modules
   If there are no results from processing the logs for a certain module that module should 
   announce that there are no actions to be taken and should be skipped
   Do a comprehensive analysis of Type1 and Type2 modules /core and /config folders
   Make sure the Type1 modules provide the necessary information for the Type2 modules
   thru the end of the project execution a nice HTML report should be created
   containing all the actions the project has taken on that run and place a copy of that report on the location where the script.bat is
   After the report is copied it should display a 120 countdown
      if no user interaction  it should remove the repo folder and restart the system
      if user interaction it should abort the countdown and leave everything as is

Remember this project must be able to run unattended on any Windows 10/11 computer
