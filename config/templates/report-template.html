<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Windows Maintenance Report - Enhanced</title>
    <link rel="stylesheet" href="report-styles.css">
    <style>
        /* Inline critical CSS */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        ::-webkit-scrollbar-track {
            background: var(--bg-color);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
    </style>
</head>
<body>
    <!-- Dark Mode Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle" title="Toggle Dark/Light Mode">
        <span class="icon" id="themeIcon">üåô</span>
        <span id="themeText">Dark Mode</span>
    </button>

    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <h1>‚öôÔ∏è Windows Maintenance Report</h1>
            <div class="subtitle">{{REPORT_SUBTITLE}}</div>
            <div class="meta">
                <div><strong>üìÖ Generated:</strong> {{GENERATION_TIME}}</div>
                <div><strong>üíª Computer:</strong> {{COMPUTER_NAME}}</div>
                <div><strong>üë§ User:</strong> {{USER_NAME}}</div>
                <div><strong>üñ•Ô∏è OS:</strong> {{OS_VERSION}}</div>
                <div><strong>‚ñ∂Ô∏è Execution Mode:</strong> {{EXECUTION_MODE}}</div>
            </div>
        </div>

        <!-- Executive Summary Section -->
        <div class="card">
            <div class="card-header">
                <h2>üìã Executive Summary</h2>
                <span class="status {{OVERALL_STATUS_CLASS}}">{{OVERALL_STATUS}}</span>
            </div>
            <div class="card-body">
                <!-- Performance Metrics -->
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-card-icon">üìä</div>
                        <div class="metric-card-value">{{TASKS_COMPLETED}}/{{TOTAL_TASKS}}</div>
                        <div class="metric-card-label">Tasks Completed</div>
                        <div class="metric-card-trend positive">‚ñ≤ {{SUCCESS_RATE}}% Success Rate</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-card-icon">‚è±Ô∏è</div>
                        <div class="metric-card-value">{{TOTAL_DURATION}}</div>
                        <div class="metric-card-label">Total Duration</div>
                        <div class="metric-card-trend">Average: {{AVG_MODULE_TIME}}</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-card-icon">üóëÔ∏è</div>
                        <div class="metric-card-value">{{BLOATWARE_REMOVED}}</div>
                        <div class="metric-card-label">Bloatware Removed</div>
                        <div class="metric-card-trend positive">{{BLOATWARE_DETECTED}} detected</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-card-icon">üì¶</div>
                        <div class="metric-card-value">{{ESSENTIAL_INSTALLED}}</div>
                        <div class="metric-card-label">Essential Apps Installed</div>
                        <div class="metric-card-trend">{{ESSENTIAL_MISSING}} missing</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-card-icon">‚ö°</div>
                        <div class="metric-card-value">{{OPTIMIZATIONS_APPLIED}}</div>
                        <div class="metric-card-label">Optimizations Applied</div>
                        <div class="metric-card-trend positive">{{REGISTRY_CHANGES}} registry changes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-card-icon">‚úÖ</div>
                        <div class="metric-card-value">{{SUCCESS_RATE}}%</div>
                        <div class="metric-card-label">Overall Success Rate</div>
                        <div class="metric-card-trend positive">High Performance</div>
                    </div>
                </div>

                <!-- Progress Bars -->
                <div style="margin-top: 30px;">
                    <div class="progress-container">
                        <div class="progress-label">
                            <span><strong>Task Completion</strong></span>
                            <span>{{TASKS_COMPLETED}} of {{TOTAL_TASKS}}</span>
                        </div>
                        <div class="progress-bar-wrapper">
                            <div class="progress-bar success" style="width: {{SUCCESS_RATE}}%"></div>
                        </div>
                    </div>

                    <div class="progress-container">
                        <div class="progress-label">
                            <span><strong>System Health</strong></span>
                            <span>{{SYSTEM_HEALTH_SCORE}}%</span>
                        </div>
                        <div class="progress-bar-wrapper">
                            <div class="progress-bar" style="width: {{SYSTEM_HEALTH_SCORE}}%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Execution Timeline -->
        <div class="collapsible-section">
            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <div class="title">
                    <span>üìÖ</span>
                    <span>Execution Timeline</span>
                </div>
                <div class="toggle-icon">‚ñº</div>
            </div>
            <div class="collapsible-content">
                <div class="execution-timeline">
                    {{EXECUTION_TIMELINE}}
                </div>
            </div>
        </div>

        <!-- Module Reports Section -->
        <div style="margin-top: 40px;">
            <h2 style="font-size: 2em; color: var(--text-color); margin-bottom: 24px; padding-bottom: 12px; border-bottom: 3px solid var(--primary-color); display: flex; align-items: center; gap: 12px;">
                üîß Detailed Module Reports
            </h2>
            {{MODULE_REPORTS}}
        </div>

        <!-- Detailed Log Viewer -->
        <div class="collapsible-section">
            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <div class="title">
                    <span>üìù</span>
                    <span>Detailed Execution Logs</span>
                </div>
                <div class="toggle-icon">‚ñº</div>
            </div>
            <div class="collapsible-content">
                <div class="log-viewer">
                    <div class="log-viewer-header">
                        <div class="log-viewer-title">
                            <span>üìã</span>
                            <span>Module Execution Logs</span>
                        </div>
                        <div class="log-filter-controls">
                            <button class="log-filter-btn active" onclick="filterLogs('all')">All</button>
                            <button class="log-filter-btn" onclick="filterLogs('error')">Errors</button>
                            <button class="log-filter-btn" onclick="filterLogs('warning')">Warnings</button>
                            <button class="log-filter-btn" onclick="filterLogs('success')">Success</button>
                            <button class="log-filter-btn" onclick="filterLogs('info')">Info</button>
                        </div>
                    </div>
                    <div class="log-entries" id="logEntries">
                        {{DETAILED_LOGS}}
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Items -->
        <div class="collapsible-section">
            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                <div class="title">
                    <span>‚úÖ</span>
                    <span>Recommended Action Items</span>
                </div>
                <div class="toggle-icon">‚ñº</div>
            </div>
            <div class="collapsible-content">
                <div class="action-items">
                    <div class="action-items-header">
                        <span>üí°</span>
                        <span>Items Requiring Attention</span>
                    </div>
                    {{ACTION_ITEMS}}
                </div>
            </div>
        </div>

        <!-- System Information Section -->
        <div class="card" style="margin-top: 40px;">
            <div class="card-header">
                <h2>üíª System Information</h2>
            </div>
            <div class="card-body">
                <div class="system-info-grid">
                    <div>
                        <h4>üñ•Ô∏è Hardware Configuration</h4>
                        <table class="info-table">
                            <tr><td><strong>Processor:</strong></td><td>{{PROCESSOR_NAME}}</td></tr>
                            <tr><td><strong>Memory:</strong></td><td>{{TOTAL_MEMORY}} GB</td></tr>
                            <tr><td><strong>Storage:</strong></td><td>{{STORAGE_INFO}}</td></tr>
                        </table>
                    </div>
                    <div>
                        <h4>üñ®Ô∏è Operating System Details</h4>
                        <table class="info-table">
                            <tr><td><strong>OS Version:</strong></td><td>{{OS_VERSION_DETAILED}}</td></tr>
                            <tr><td><strong>Build Number:</strong></td><td>{{BUILD_NUMBER}}</td></tr>
                            <tr><td><strong>Last Boot:</strong></td><td>{{LAST_BOOT_TIME}}</td></tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div style="text-align: center; margin-top: 50px; padding: 30px 0; color: var(--text-secondary); border-top: 2px solid var(--border-color); font-size: 0.9em;">
            <p>üìÑ Windows Maintenance Report Generated on {{GENERATION_TIME}}</p>
            <p style="margin-top: 8px; opacity: 0.7;">This report contains maintenance operations and system optimization results.</p>
            <p style="margin-top: 8px; opacity: 0.7;">‚ö° Powered by Windows Maintenance Automation v3.0</p>
        </div>
    </div>

    <script>
        // Dark Mode Toggle
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            const icon = document.getElementById('themeIcon');
            const text = document.getElementById('themeText');
            
            if (newTheme === 'dark') {
                icon.textContent = '‚òÄÔ∏è';
                text.textContent = 'Light Mode';
            } else {
                icon.textContent = 'üåô';
                text.textContent = 'Dark Mode';
            }
        }

        // Load saved theme
        window.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            if (savedTheme === 'dark') {
                document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';
                document.getElementById('themeText').textContent = 'Light Mode';
            }
        });

        // Collapsible Sections
        function toggleCollapsible(header) {
            header.classList.toggle('active');
            const content = header.nextElementSibling;
            content.classList.toggle('active');
        }

        // Log Filtering
        function filterLogs(level) {
            const entries = document.querySelectorAll('.log-entry');
            const buttons = document.querySelectorAll('.log-filter-btn');
            
            // Update active button
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Filter entries
            entries.forEach(entry => {
                if (level === 'all' || entry.classList.contains(level)) {
                    entry.style.display = 'flex';
                } else {
                    entry.style.display = 'none';
                }
            });
        }

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Print functionality
        function printReport() {
            window.print();
        }

        // Export to PDF (browser print to PDF)
        function exportToPDF() {
            window.print();
        }
    </script>
</body>
</html>
