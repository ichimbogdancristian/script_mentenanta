<!-- Enhanced Module Card Template for Windows Maintenance Reports -->
<!-- This template should be used for {{MODULE_REPORTS}} placeholder -->

<div class="module-card status-{{MODULE_STATUS}}" data-module="{{MODULE_NAME}}">
    <!-- Module Header -->
    <div class="module-header">
        <div class="module-icon">{{MODULE_ICON}}</div>
        <div class="module-title-section">
            <h3 class="module-title">{{MODULE_DISPLAY_NAME}}</h3>
            <span class="module-duration">
                <span class="duration-icon">‚è±Ô∏è</span>
                <span class="duration-text">{{MODULE_DURATION}}</span>
            </span>
        </div>
        <div class="module-status-badge">
            <span class="status-badge {{MODULE_STATUS}}">
                <span class="status-icon">{{STATUS_ICON}}</span>
                <span class="status-text">{{STATUS_TEXT}}</span>
            </span>
        </div>
    </div>

    <!-- Module Metrics Grid -->
    <div class="module-metrics">
        <div class="module-metric">
            <div class="metric-icon">üîç</div>
            <div class="metric-content">
                <span class="metric-value">{{ITEMS_DETECTED}}</span>
                <span class="metric-label">Detected</span>
            </div>
        </div>
        <div class="module-metric">
            <div class="metric-icon">‚úÖ</div>
            <div class="metric-content">
                <span class="metric-value">{{ITEMS_PROCESSED}}</span>
                <span class="metric-label">Processed</span>
            </div>
        </div>
        <div class="module-metric">
            <div class="metric-icon">‚è≠Ô∏è</div>
            <div class="metric-content">
                <span class="metric-value">{{ITEMS_SKIPPED}}</span>
                <span class="metric-label">Skipped</span>
            </div>
        </div>
        <div class="module-metric">
            <div class="metric-icon">‚ùå</div>
            <div class="metric-content">
                <span class="metric-value">{{ITEMS_FAILED}}</span>
                <span class="metric-label">Failed</span>
            </div>
        </div>
    </div>

    <!-- Module Summary -->
    <div class="module-summary">
        <p class="summary-text">{{MODULE_SUMMARY}}</p>
    </div>

    <!-- Toggle Details Button -->
    <div class="module-details-toggle">
        <button class="details-toggle-btn" onclick="toggleModuleDetails(this)" aria-expanded="false">
            <span class="details-text">Show Details</span>
            <span class="details-icon">‚ñº</span>
        </button>
    </div>

    <!-- Collapsible Details Section -->
    <div class="module-details" style="display: none;">
        
        <!-- Results Section (for Type1 audit or Type2 items) -->
        <div class="detail-section results-section" style="display: {{RESULTS_DISPLAY}};">
            <div class="detail-header">
                <h4 class="detail-title">
                    <span class="detail-icon">üìä</span>
                    {{RESULTS_TITLE}}
                </h4>
            </div>
            <div class="detail-content">
                {{MODULE_RESULTS}}
            </div>
        </div>

        <!-- Changes Section (for Type2 modifications) -->
        <div class="detail-section changes-section" style="display: {{CHANGES_DISPLAY}};">
            <div class="detail-header">
                <h4 class="detail-title">
                    <span class="detail-icon">üîÑ</span>
                    Changes Applied
                </h4>
            </div>
            <div class="detail-content">
                <div class="changes-grid">
                    {{MODULE_CHANGES}}
                </div>
            </div>
        </div>

        <!-- Execution Log Section -->
        <div class="detail-section log-section">
            <div class="detail-header">
                <h4 class="detail-title">
                    <span class="detail-icon">üìù</span>
                    Execution Log
                    <span class="log-count-badge">{{LOG_ENTRIES_COUNT}} entries</span>
                </h4>
                <div class="log-mini-filter">
                    <button class="mini-filter-btn active" onclick="filterModuleLog(this, 'all')">All</button>
                    <button class="mini-filter-btn" onclick="filterModuleLog(this, 'error')">Errors</button>
                    <button class="mini-filter-btn" onclick="filterModuleLog(this, 'warning')">Warnings</button>
                </div>
            </div>
            <div class="detail-content">
                <div class="log-viewer compact">
                    {{MODULE_LOG_ENTRIES}}
                </div>
            </div>
        </div>

        <!-- Performance Breakdown Section -->
        <div class="detail-section performance-section">
            <div class="detail-header">
                <h4 class="detail-title">
                    <span class="detail-icon">‚ö°</span>
                    Performance Breakdown
                </h4>
            </div>
            <div class="detail-content">
                <div class="performance-bars">
                    {{PERFORMANCE_PHASES}}
                </div>
                <div class="performance-stats">
                    <div class="perf-stat">
                        <span class="perf-label">Start Time:</span>
                        <span class="perf-value">{{START_TIME}}</span>
                    </div>
                    <div class="perf-stat">
                        <span class="perf-label">End Time:</span>
                        <span class="perf-value">{{END_TIME}}</span>
                    </div>
                    <div class="perf-stat">
                        <span class="perf-label">Total Duration:</span>
                        <span class="perf-value">{{MODULE_DURATION}}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Errors & Warnings Section (if any) -->
        <div class="detail-section errors-section" style="display: {{ERRORS_SECTION_DISPLAY}};">
            <div class="detail-header error">
                <h4 class="detail-title">
                    <span class="detail-icon">‚ö†Ô∏è</span>
                    Errors & Warnings
                    <span class="error-count-badge">{{ERROR_WARNING_COUNT}}</span>
                </h4>
            </div>
            <div class="detail-content">
                <div class="module-errors-list">
                    {{MODULE_ERRORS}}
                </div>
            </div>
        </div>

        <!-- Recommendations Section -->
        <div class="detail-section recommendations-section" style="display: {{RECOMMENDATIONS_DISPLAY}};">
            <div class="detail-header info">
                <h4 class="detail-title">
                    <span class="detail-icon">üí°</span>
                    Recommendations
                </h4>
            </div>
            <div class="detail-content">
                <ul class="recommendations-list">
                    {{MODULE_RECOMMENDATIONS}}
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Module Log Entry Template (for {{MODULE_LOG_ENTRIES}}) -->
<div class="log-entry {{LOG_LEVEL}}" data-level="{{LOG_LEVEL}}">
    <span class="log-time">{{LOG_TIME}}</span>
    <span class="log-level-badge">{{LOG_LEVEL_TEXT}}</span>
    <span class="log-message">{{LOG_MESSAGE}}</span>
</div>

<!-- Performance Phase Template (for {{PERFORMANCE_PHASES}}) -->
<div class="performance-phase">
    <div class="phase-info">
        <span class="phase-name">{{PHASE_NAME}}</span>
        <span class="phase-duration">{{PHASE_DURATION}}</span>
    </div>
    <div class="phase-bar-container">
        <div class="phase-bar" style="width: {{PHASE_PERCENT}}%;" title="{{PHASE_PERCENT}}% of total time">
            <span class="phase-percent">{{PHASE_PERCENT}}%</span>
        </div>
    </div>
</div>

<!-- Module Error Item Template (for {{MODULE_ERRORS}}) -->
<div class="module-error-item {{ERROR_SEVERITY}}">
    <div class="error-item-header">
        <span class="error-icon">{{ERROR_ICON}}</span>
        <span class="error-title">{{ERROR_TITLE}}</span>
        <span class="error-time">{{ERROR_TIME}}</span>
    </div>
    <div class="error-item-message">
        {{ERROR_MESSAGE}}
    </div>
    <div class="error-item-actions" style="display: {{ERROR_SOLUTION_DISPLAY}};">
        <button class="error-action-btn" onclick="toggleErrorSolution(this)">
            <span class="btn-icon">üìñ</span>
            <span>View Solution</span>
        </button>
    </div>
    <div class="error-solution" style="display: none;">
        {{ERROR_SOLUTION}}
    </div>
</div>

<!-- Finding Item Template (for {{KEY_FINDINGS}}) -->
<div class="finding-item {{FINDING_TYPE}}">
    <div class="finding-icon">{{FINDING_ICON}}</div>
    <div class="finding-content">
        <div class="finding-text">{{FINDING_TEXT}}</div>
        <div class="finding-meta">
            <span class="finding-module">{{FINDING_MODULE}}</span>
            <span class="finding-time">{{FINDING_TIME}}</span>
        </div>
    </div>
</div>

<!-- Action Item Template (for {{ACTION_ITEMS}} and {{ACTION_ITEMS_SUMMARY}}) -->
<div class="action-item priority-{{ACTION_PRIORITY}}">
    <div class="action-number">{{ACTION_NUMBER}}</div>
    <div class="action-content">
        <div class="action-title">{{ACTION_TITLE}}</div>
        <div class="action-description">{{ACTION_DESCRIPTION}}</div>
        <div class="action-meta">
            <span class="action-module">From: {{ACTION_MODULE}}</span>
            <span class="action-priority-badge">{{ACTION_PRIORITY_TEXT}}</span>
        </div>
    </div>
</div>

<!-- Timeline Entry Template (for {{EXECUTION_TIMELINE}}) -->
<div class="timeline-entry">
    <div class="timeline-marker {{TIMELINE_STATUS}}">
        <span class="timeline-icon">{{TIMELINE_ICON}}</span>
    </div>
    <div class="timeline-content">
        <div class="timeline-time">{{TIMELINE_TIME}}</div>
        <div class="timeline-title">{{TIMELINE_TITLE}}</div>
        <div class="timeline-description">{{TIMELINE_DESCRIPTION}}</div>
        <div class="timeline-duration">{{TIMELINE_DURATION}}</div>
    </div>
</div>

<!-- JavaScript helper for module-specific log filtering -->
<script>
function filterModuleLog(button, level) {
    const moduleCard = button.closest('.module-card');
    const logEntries = moduleCard.querySelectorAll('.log-entry');
    const filterButtons = moduleCard.querySelectorAll('.mini-filter-btn');
    
    // Update active button
    filterButtons.forEach(btn => btn.classList.remove('active'));
    button.classList.add('active');
    
    // Filter log entries
    logEntries.forEach(entry => {
        if (level === 'all' || entry.dataset.level === level) {
            entry.style.display = 'flex';
        } else {
            entry.style.display = 'none';
        }
    });
}

function toggleErrorSolution(button) {
    const errorItem = button.closest('.module-error-item');
    const solution = errorItem.querySelector('.error-solution');
    const btnText = button.querySelector('span:last-child');
    
    if (solution.style.display === 'none' || solution.style.display === '') {
        solution.style.display = 'block';
        btnText.textContent = 'Hide Solution';
    } else {
        solution.style.display = 'none';
        btnText.textContent = 'View Solution';
    }
}
</script>
