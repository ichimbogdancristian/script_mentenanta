<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Windows Maintenance Report - Modern comprehensive system analysis and optimization results">
    <meta name="theme-color" content="#3b82f6">
    <meta name="author" content="Windows Maintenance Automation">
    <title>‚öôÔ∏è Windows Maintenance Report - {{GENERATION_TIME}}</title>
    
    <!-- Modern Stylesheets -->
    <style>{{CSS_CONTENT}}</style>
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Enhanced Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E‚öôÔ∏è%3C/text%3E%3C/svg%3E">
    
    <!-- Critical CSS for above-the-fold content -->
    <style>
        body { opacity: 0; transition: opacity 0.3s ease-in-out; }
        body.loaded { opacity: 1; }
    </style>
</head>
<body>
    <!-- Accessibility Skip Link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Scroll Progress Indicator -->
    <div class="scroll-progress" role="progressbar" aria-label="Reading progress">
        <div class="scroll-progress-bar" id="scroll-progress"></div>
    </div>

    <!-- Modern Floating Controls -->
    <div class="top-controls-bar" role="toolbar" aria-label="Report controls">
        <button 
            class="theme-toggle control-btn" 
            id="themeToggle" 
            onclick="toggleTheme()" 
            title="Toggle theme (Ctrl+T)" 
            aria-label="Switch between light and dark theme"
            aria-pressed="false"
        >
            <span class="icon" id="themeIcon" aria-hidden="true">üåô</span>
            <span id="themeText">Dark Mode</span>
        </button>
        
        <button 
            class="control-btn" 
            onclick="printReport()" 
            title="Print report (Ctrl+P)" 
            aria-label="Print this report"
        >
            <span class="icon" aria-hidden="true">üñ®Ô∏è</span>
            <span>Print</span>
        </button>
        
        <button 
            class="control-btn" 
            onclick="exportToJSON()" 
            title="Export data as JSON" 
            aria-label="Export report data"
        >
            <span class="icon" aria-hidden="true">üìä</span>
            <span>Export</span>
        </button>
        
        <button 
            class="control-btn" 
            onclick="toggleFullscreen()" 
            title="Toggle fullscreen (F11)" 
            aria-label="Toggle fullscreen mode"
        >
            <span class="icon" aria-hidden="true">üî≥</span>
            <span>Fullscreen</span>
        </button>
    </div>

    <div class="report-container">
        <main id="main-content" class="container">
            <!-- Modern Hero Header -->
            <header class="report-header fade-in">
                <div class="header-content">
                    <h1 class="header-title">‚öôÔ∏è Windows Maintenance Report</h1>
                    <p class="header-subtitle">{{REPORT_SUBTITLE}}</p>
                    
                    <nav class="header-breadcrumb" aria-label="Report navigation">
                        <a href="#executive-dashboard" class="breadcrumb-link">üìä Dashboard</a>
                        <a href="#metrics-section" class="breadcrumb-link">üìà Metrics</a>
                        <a href="#modules-section" class="breadcrumb-link">üîß Modules</a>
                        <a href="#system-info" class="breadcrumb-link">üíª System</a>
                    </nav>
                    
                    <div class="header-meta">
                        <div class="meta-card">
                            <div class="meta-label">Generated</div>
                            <div class="meta-value">{{GENERATION_TIME}}</div>
                        </div>
                        <div class="meta-card">
                            <div class="meta-label">Computer</div>
                            <div class="meta-value">{{COMPUTER_NAME}}</div>
                        </div>
                        <div class="meta-card">
                            <div class="meta-label">User</div>
                            <div class="meta-value">{{USER_NAME}}</div>
                        </div>
                        <div class="meta-card">
                            <div class="meta-label">Mode</div>
                            <div class="meta-value">{{EXECUTION_MODE}}</div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Executive Dashboard -->
            <section id="executive-dashboard" class="executive-dashboard slide-up" aria-labelledby="dashboard-title">
                <div class="dashboard-header">
                    <h2 id="dashboard-title" class="dashboard-title">üìä Executive Dashboard</h2>
                    <p class="dashboard-subtitle">Key performance indicators and system health overview</p>
                </div>

                <div class="metrics-grid">
                    <div class="metric-card interactive" data-metric="total-modules">
                        <div class="metric-header">
                            <div class="metric-icon" aria-hidden="true">üîß</div>
                            <div class="metric-trend trend-up">+12%</div>
                        </div>
                        <div class="metric-value">{{TOTAL_MODULES}}</div>
                        <div class="metric-label">Total Modules</div>
                        <div class="metric-description">Maintenance modules executed in this session</div>
                        <div class="metric-progress">
                            <div class="progress-label">
                                <span>Progress</span>
                                <span>{{MODULE_COMPLETION_PERCENT}}%</span>
                            </div>
                            <div class="progress-track">
                                <div class="progress-fill" style="width: {{MODULE_COMPLETION_PERCENT}}%"></div>
                            </div>
                        </div>
                    </div>

                    <div class="metric-card interactive" data-metric="system-health">
                        <div class="metric-header">
                            <div class="metric-icon" aria-hidden="true" style="background: linear-gradient(135deg, var(--success-500), var(--success-600));">üíö</div>
                            <div class="metric-trend trend-up">Good</div>
                        </div>
                        <div class="metric-value">{{SYSTEM_HEALTH_SCORE}}%</div>
                        <div class="metric-label">System Health</div>
                        <div class="metric-description">Overall system optimization and security status</div>
                        <div class="metric-progress">
                            <div class="progress-label">
                                <span>Health Score</span>
                                <span>{{SYSTEM_HEALTH_SCORE}}%</span>
                            </div>
                            <div class="progress-track">
                                <div class="progress-fill success" style="width: {{SYSTEM_HEALTH_SCORE}}%"></div>
                            </div>
                        </div>
                    </div>

                    <div class="metric-card interactive" data-metric="issues-resolved">
                        <div class="metric-header">
                            <div class="metric-icon" aria-hidden="true" style="background: linear-gradient(135deg, var(--warning-500), var(--warning-600));">‚ö°</div>
                            <div class="metric-trend trend-neutral">{{ISSUES_STATUS}}</div>
                        </div>
                        <div class="metric-value">{{ISSUES_RESOLVED}}</div>
                        <div class="metric-label">Issues Resolved</div>
                        <div class="metric-description">System issues addressed and fixed</div>
                        <div class="metric-progress">
                            <div class="progress-label">
                                <span>Resolution Rate</span>
                                <span>{{RESOLUTION_RATE}}%</span>
                            </div>
                            <div class="progress-track">
                                <div class="progress-fill warning" style="width: {{RESOLUTION_RATE}}%"></div>
                            </div>
                        </div>
                    </div>

                    <div class="metric-card interactive" data-metric="execution-time">
                        <div class="metric-header">
                            <div class="metric-icon" aria-hidden="true" style="background: linear-gradient(135deg, var(--info-500), var(--info-600));">‚è±Ô∏è</div>
                            <div class="metric-trend trend-down">-8%</div>
                        </div>
                        <div class="metric-value">{{EXECUTION_TIME}}</div>
                        <div class="metric-label">Execution Time</div>
                        <div class="metric-description">Total time taken for maintenance operations</div>
                        <div class="metric-progress">
                            <div class="progress-label">
                                <span>Efficiency</span>
                                <span>{{EFFICIENCY_SCORE}}%</span>
                            </div>
                            <div class="progress-track">
                                <div class="progress-fill" style="width: {{EFFICIENCY_SCORE}}%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Modules Section -->
            <section id="modules-section" class="modules-section" aria-labelledby="modules-title">
                <h2 id="modules-title" class="dashboard-title">üîß Maintenance Modules</h2>
                <p class="dashboard-subtitle">Detailed results from each maintenance component</p>

                <div class="modules-grid">
                    {{MODULE_SECTIONS}}
                </div>
            </section>

            <!-- System Information -->
            <section id="system-info" class="executive-dashboard" aria-labelledby="system-title">
                <div class="dashboard-header">
                    <h2 id="system-title" class="dashboard-title">üíª System Information</h2>
                    <p class="dashboard-subtitle">Hardware and software environment details</p>
                </div>

                <div class="modules-grid">
                    <div class="module-card">
                        <div class="module-header">
                            <div class="module-title-group">
                                <div class="module-icon" style="background: linear-gradient(135deg, var(--info-500), var(--info-600));" aria-hidden="true">üñ•Ô∏è</div>
                                <div>
                                    <h3 class="module-title">Hardware Information</h3>
                                    <p class="module-description">System specifications and hardware details</p>
                                </div>
                            </div>
                        </div>
                        <div class="module-body expanded">
                            <div class="items-section">
                                <h4 class="section-title">üíæ System Specifications</h4>
                                <div class="items-list">
                                    <div class="item">
                                        <strong>Processor:</strong> {{PROCESSOR_INFO}}
                                    </div>
                                    <div class="item">
                                        <strong>Memory:</strong> {{MEMORY_INFO}}
                                    </div>
                                    <div class="item">
                                        <strong>Storage:</strong> {{STORAGE_INFO}}
                                    </div>
                                    <div class="item">
                                        <strong>Graphics:</strong> {{GRAPHICS_INFO}}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="module-card">
                        <div class="module-header">
                            <div class="module-title-group">
                                <div class="module-icon" style="background: linear-gradient(135deg, var(--primary-500), var(--primary-600));" aria-hidden="true">üîß</div>
                                <div>
                                    <h3 class="module-title">Software Environment</h3>
                                    <p class="module-description">Operating system and software details</p>
                                </div>
                            </div>
                        </div>
                        <div class="module-body expanded">
                            <div class="items-section">
                                <h4 class="section-title">üîß Environment Details</h4>
                                <div class="items-list">
                                    <div class="item">
                                        <strong>OS Version:</strong> {{OS_VERSION}}
                                    </div>
                                    <div class="item">
                                        <strong>PowerShell:</strong> {{POWERSHELL_VERSION}}
                                    </div>
                                    <div class="item">
                                        <strong>Domain:</strong> {{DOMAIN_INFO}}
                                    </div>
                                    <div class="item">
                                        <strong>IP Address:</strong> {{IPV4_ADDRESS}}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Summary Section -->
            {{SUMMARY_SECTION}}
        </main>

        <!-- Modern Footer -->
        <footer class="report-footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>üìÑ About This Report</h4>
                    <p>This comprehensive maintenance report contains detailed analysis of system optimizations, security enhancements, and performance improvements applied to your Windows system.</p>
                    <p>Generated using advanced PowerShell automation with modern web technologies for optimal presentation.</p>
                </div>
                <div class="footer-section">
                    <h4>üîó Quick Navigation</h4>
                    <ul class="footer-links">
                        <li><a href="#executive-dashboard">üìä Executive Dashboard</a></li>
                        <li><a href="#metrics-section">üìà Performance Metrics</a></li>
                        <li><a href="#modules-section">üîß Module Details</a></li>
                        <li><a href="#system-info">üíª System Information</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>üìã Report Details</h4>
                    <ul class="footer-links">
                        <li><strong>Generated:</strong> {{GENERATION_TIME}}</li>
                        <li><strong>System:</strong> {{COMPUTER_NAME}}</li>
                        <li><strong>Version:</strong> 5.0 Enhanced</li>
                        <li><strong>Tool:</strong> Windows Maintenance Automation</li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>‚ö° Features</h4>
                    <ul class="footer-links">
                        <li>üåì Dark/Light Mode Toggle</li>
                        <li>üì± Mobile Responsive Design</li>
                        <li>üñ®Ô∏è Print-Optimized Layout</li>
                        <li>‚ôø Accessibility Compliant</li>
                        <li>üìä Interactive Data Export</li>
                        <li>üîç Advanced Module Filtering</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>üõ°Ô∏è Windows Maintenance Report v5.0 Enhanced | Generated by Windows Maintenance Automation</p>
                <p style="font-size: 0.85em; opacity: 0.8; margin-top: 0.5rem;">
                    ‚ö° Modern dashboard with glassmorphism effects, advanced animations, and responsive design
                </p>
            </div>
        </footer>
    </div>

    <!-- Back to Top Button -->
    <button 
        class="back-to-top" 
        id="back-to-top" 
        onclick="scrollToTop()" 
        title="Back to top (Home key)" 
        aria-label="Scroll back to top of report"
    >
        <span aria-hidden="true">‚Üë</span>
    </button>

    <!-- Enhanced JavaScript -->
    <script>
        // Initialize Dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeDashboard();
            document.body.classList.add('loaded');
        });

        // Dashboard Controller
        const Dashboard = {
            currentTheme: localStorage.getItem('dashboard-theme') || 'light',
            scrollProgress: null,
            backToTopButton: null,

            init() {
                this.setupElements();
                this.setupEventListeners();
                this.loadTheme();
                this.setupScrollProgress();
                this.setupKeyboardShortcuts();
                this.setupAccessibility();
                this.animateOnLoad();
            },

            setupElements() {
                this.scrollProgress = document.getElementById('scroll-progress');
                this.backToTopButton = document.getElementById('back-to-top');
            },

            setupEventListeners() {
                // Scroll events
                window.addEventListener('scroll', this.debounce(() => {
                    this.updateScrollProgress();
                    this.updateBackToTopVisibility();
                }, 16));

                // Resize events
                window.addEventListener('resize', this.debounce(() => {
                    this.handleResize();
                }, 250));

                // Intersection Observer for animations
                this.setupIntersectionObserver();
            },

            setupIntersectionObserver() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.style.animationDelay = '0s';
                            entry.target.classList.add('fade-in');
                        }
                    });
                }, { threshold: 0.1, rootMargin: '50px' });

                document.querySelectorAll('.metric-card, .module-card').forEach(el => {
                    observer.observe(el);
                });
            },

            loadTheme() {
                this.setTheme(this.currentTheme);
            },

            setTheme(theme) {
                this.currentTheme = theme;
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('dashboard-theme', theme);

                const themeIcon = document.getElementById('themeIcon');
                const themeText = document.getElementById('themeText');
                const themeToggle = document.getElementById('themeToggle');

                if (themeIcon && themeText && themeToggle) {
                    if (theme === 'dark') {
                        themeIcon.textContent = '‚òÄÔ∏è';
                        themeText.textContent = 'Light Mode';
                        themeToggle.setAttribute('aria-pressed', 'true');
                    } else {
                        themeIcon.textContent = 'üåô';
                        themeText.textContent = 'Dark Mode';
                        themeToggle.setAttribute('aria-pressed', 'false');
                    }
                }

                this.announceToScreenReader(`Switched to ${theme} mode`);
            },

            toggleTheme() {
                const newTheme = this.currentTheme === 'light' ? 'dark' : 'light';
                this.setTheme(newTheme);
            },

            updateScrollProgress() {
                if (!this.scrollProgress) return;

                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                const scrollHeight = document.documentElement.scrollHeight - window.innerHeight;
                const progress = (scrollTop / scrollHeight) * 100;

                this.scrollProgress.style.width = `${Math.min(progress, 100)}%`;
            },

            updateBackToTopVisibility() {
                if (!this.backToTopButton) return;

                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                const shouldShow = scrollTop > 300;

                this.backToTopButton.classList.toggle('visible', shouldShow);
            },

            scrollToTop() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });

                // Focus management for accessibility
                const skipLink = document.querySelector('.skip-link');
                if (skipLink) {
                    skipLink.focus();
                }
            },

            scrollToSection(sectionId) {
                const section = document.getElementById(sectionId);
                if (section) {
                    const headerOffset = 80;
                    const elementPosition = section.getBoundingClientRect().top;
                    const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });

                    this.announceToScreenReader(`Navigated to ${sectionId} section`);
                }
            },

            setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

                    switch (e.key) {
                        case 't':
                            if (e.ctrlKey || e.metaKey) {
                                e.preventDefault();
                                this.toggleTheme();
                            }
                            break;
                        case 'p':
                            if (e.ctrlKey || e.metaKey) {
                                e.preventDefault();
                                printReport();
                            }
                            break;
                        case 'Home':
                            e.preventDefault();
                            this.scrollToTop();
                            break;
                        case 'F11':
                            e.preventDefault();
                            toggleFullscreen();
                            break;
                    }
                });
            },

            setupAccessibility() {
                // High contrast mode detection
                if (window.matchMedia('(prefers-contrast: high)').matches) {
                    document.documentElement.classList.add('high-contrast');
                }

                // Reduced motion detection
                if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                    document.documentElement.classList.add('reduce-motion');
                }

                // Color scheme preference
                if (window.matchMedia('(prefers-color-scheme: dark)').matches && !localStorage.getItem('dashboard-theme')) {
                    this.setTheme('dark');
                }
            },

            animateOnLoad() {
                // Stagger metric card animations
                const metricCards = document.querySelectorAll('.metric-card');
                metricCards.forEach((card, index) => {
                    card.style.animationDelay = `${index * 0.1}s`;
                });

                // Animate progress bars
                setTimeout(() => {
                    document.querySelectorAll('.progress-fill').forEach(bar => {
                        const targetWidth = bar.style.width;
                        bar.style.width = '0%';
                        setTimeout(() => {
                            bar.style.width = targetWidth;
                        }, 100);
                    });
                }, 1000);
            },

            handleResize() {
                // Update layout for responsive design
                const isMobile = window.innerWidth < 768;
                document.documentElement.classList.toggle('mobile', isMobile);
            },

            announceToScreenReader(message) {
                let liveRegion = document.getElementById('sr-live-region');
                if (!liveRegion) {
                    liveRegion = document.createElement('div');
                    liveRegion.id = 'sr-live-region';
                    liveRegion.setAttribute('aria-live', 'polite');
                    liveRegion.setAttribute('aria-atomic', 'true');
                    liveRegion.className = 'sr-only';
                    document.body.appendChild(liveRegion);
                }

                liveRegion.textContent = message;
                setTimeout(() => {
                    liveRegion.textContent = '';
                }, 1000);
            },

            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }
        };

        // Global functions
        function initializeDashboard() {
            Dashboard.init();
        }

        function toggleTheme() {
            Dashboard.toggleTheme();
        }

        function scrollToTop() {
            Dashboard.scrollToTop();
        }

        function scrollToSection(sectionId) {
            Dashboard.scrollToSection(sectionId);
        }

        function printReport() {
            // Optimize for printing
            document.body.classList.add('printing');
            
            // Expand all modules for complete print
            document.querySelectorAll('.module-body').forEach(body => {
                body.style.display = 'block';
                body.classList.add('expanded');
            });

            setTimeout(() => {
                window.print();
                
                setTimeout(() => {
                    document.body.classList.remove('printing');
                }, 1000);
            }, 100);
        }

        function exportToJSON() {
            const reportData = {
                metadata: {
                    generatedAt: new Date().toISOString(),
                    userAgent: navigator.userAgent,
                    reportVersion: '5.0'
                },
                summary: gatherSummaryData(),
                timestamp: Date.now()
            };

            const dataStr = JSON.stringify(reportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });

            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `maintenance-report-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            Dashboard.announceToScreenReader('Report exported successfully');
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.warn('Error attempting to enable fullscreen:', err);
                });
            } else {
                document.exitFullscreen();
            }
        }

        function gatherSummaryData() {
            const metrics = {};
            document.querySelectorAll('.metric-card').forEach(card => {
                const label = card.querySelector('.metric-label')?.textContent;
                const value = card.querySelector('.metric-value')?.textContent;
                if (label && value) {
                    metrics[label] = value;
                }
            });
            return metrics;
        }

        // Module toggle functions
        function toggleModuleDetails(moduleId) {
            const body = document.getElementById(`module-body-${moduleId}`);
            const icon = document.querySelector(`[onclick*="${moduleId}"] .expand-toggle`);

            if (body && icon) {
                const isExpanded = body.classList.contains('expanded');

                if (isExpanded) {
                    body.classList.remove('expanded');
                    body.style.display = 'none';
                    icon.innerHTML = '‚ñ∂';
                } else {
                    body.style.display = 'block';
                    body.classList.add('expanded');
                    icon.innerHTML = '‚ñº';
                }

                const moduleName = body.closest('.module-card')?.querySelector('.module-title')?.textContent || 'module';
                Dashboard.announceToScreenReader(`${moduleName} details ${isExpanded ? 'collapsed' : 'expanded'}`);
            }
        }
    </script>
</body>
</html>