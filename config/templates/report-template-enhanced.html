<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Windows Maintenance Report - System analysis and optimization results">
    <meta name="theme-color" content="#0078d4">
    <title>‚öôÔ∏è Windows Maintenance Report</title>
    <link rel="stylesheet" href="report-styles.css">
</head>
<body>
    <!-- Accessibility Skip Link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Controls Bar -->
    <div class="top-controls">
        <!-- Dark Mode Toggle -->
        <button 
            class="theme-toggle" 
            onclick="toggleTheme()" 
            id="themeToggle" 
            title="Toggle Dark/Light Mode (Ctrl+Shift+D)"
            aria-label="Toggle between light and dark mode"
            aria-pressed="false">
            <span class="icon" id="themeIcon" aria-hidden="true">üåô</span>
            <span id="themeText">Dark Mode</span>
        </button>

        <!-- Report Controls -->
        <div class="report-controls">
            <button class="control-btn print-btn" onclick="printReport()" title="Print report (Ctrl+P)" aria-label="Print this report">
                <span aria-hidden="true">üñ®Ô∏è</span> Print
            </button>
            <button class="control-btn pdf-btn" onclick="exportToPDF()" title="Export as PDF" aria-label="Export report as PDF">
                <span aria-hidden="true">üìÑ</span> PDF
            </button>
            <button class="control-btn scroll-btn" onclick="scrollToTop()" title="Go to top" aria-label="Scroll back to top of report">
                <span aria-hidden="true">‚¨ÜÔ∏è</span> Top
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main id="main-content" class="report-container">
        <!-- Header Section with Hero Design -->
        <header class="report-header">
            <div class="header-content">
                <h1>‚öôÔ∏è Windows Maintenance Report</h1>
                <p class="header-subtitle">{{REPORT_SUBTITLE}}</p>
                
                <!-- Navigation Links -->
                <nav class="header-nav" aria-label="Report sections">
                    <a href="#executive-summary" class="nav-link">Summary</a>
                    <a href="#metrics-section" class="nav-link">Metrics</a>
                    <a href="#modules-section" class="nav-link">Modules</a>
                    <a href="#timeline-section" class="nav-link">Timeline</a>
                    <a href="#logs-section" class="nav-link">Logs</a>
                    <a href="#system-section" class="nav-link">System</a>
                </nav>
            </div>

            <!-- Metadata -->
            <div class="header-metadata">
                <div class="metadata-grid">
                    <div class="metadata-item">
                        <span class="metadata-icon">üìÖ</span>
                        <div class="metadata-content">
                            <strong>Generated</strong>
                            <p>{{GENERATION_TIME}}</p>
                        </div>
                    </div>
                    <div class="metadata-item">
                        <span class="metadata-icon">üíª</span>
                        <div class="metadata-content">
                            <strong>Computer</strong>
                            <p>{{COMPUTER_NAME}}</p>
                        </div>
                    </div>
                    <div class="metadata-item">
                        <span class="metadata-icon">üë§</span>
                        <div class="metadata-content">
                            <strong>User</strong>
                            <p>{{USER_NAME}}</p>
                        </div>
                    </div>
                    <div class="metadata-item">
                        <span class="metadata-icon">üñ•Ô∏è</span>
                        <div class="metadata-content">
                            <strong>OS Version</strong>
                            <p>{{OS_VERSION}}</p>
                        </div>
                    </div>
                    <div class="metadata-item">
                        <span class="metadata-icon">‚ö°</span>
                        <div class="metadata-content">
                            <strong>Execution Mode</strong>
                            <p>{{EXECUTION_MODE}}</p>
                        </div>
                    </div>
                    <div class="metadata-item">
                        <span class="metadata-icon">‚úÖ</span>
                        <div class="metadata-content">
                            <strong>Status</strong>
                            <p class="status {{OVERALL_STATUS_CLASS}}">{{OVERALL_STATUS}}</p>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Executive Summary with Quick Links -->
        <section id="executive-summary" class="card card-primary">
            <header class="card-header">
                <h2>üìã Executive Summary</h2>
            </header>
            <div class="card-body">
                <!-- Quick Links Flexbox -->
                <div class="quick-links-container">
                    <a href="#metrics-section" class="quick-link-box">
                        <span class="ql-icon">üìä</span>
                        <span class="ql-title">Key Metrics</span>
                        <span class="ql-desc">Performance overview</span>
                    </a>
                    <a href="#modules-section" class="quick-link-box">
                        <span class="ql-icon">üîß</span>
                        <span class="ql-title">Modules</span>
                        <span class="ql-desc">Detailed reports</span>
                    </a>
                    <a href="#timeline-section" class="quick-link-box">
                        <span class="ql-icon">üìÖ</span>
                        <span class="ql-title">Timeline</span>
                        <span class="ql-desc">Execution sequence</span>
                    </a>
                    <a href="#logs-section" class="quick-link-box">
                        <span class="ql-icon">üìù</span>
                        <span class="ql-title">Logs</span>
                        <span class="ql-desc">Detailed logs</span>
                    </a>
                    <a href="#actions-section" class="quick-link-box">
                        <span class="ql-icon">‚úÖ</span>
                        <span class="ql-title">Actions</span>
                        <span class="ql-desc">Recommended items</span>
                    </a>
                    <a href="#system-section" class="quick-link-box">
                        <span class="ql-icon">üñ•Ô∏è</span>
                        <span class="ql-title">System Info</span>
                        <span class="ql-desc">Hardware details</span>
                    </a>
                </div>

                <!-- Summary Text -->
                <div class="summary-text">
                    <p>{{SUMMARY_TEXT}}</p>
                </div>
            </div>
        </section>

        <!-- Performance Metrics Section -->
        <section id="metrics-section" class="metrics-section">
            <h2 class="section-title">üìä Key Performance Metrics</h2>
            
            <!-- Metrics Cards in Flexbox Grid -->
            <div class="metrics-grid">
                <div class="metric-box">
                    <div class="metric-icon">‚úÖ</div>
                    <div class="metric-value">{{TASKS_COMPLETED}}/{{TOTAL_TASKS}}</div>
                    <div class="metric-label">Tasks Completed</div>
                    <div class="metric-trend positive">{{SUCCESS_RATE}}% Success</div>
                </div>

                <div class="metric-box">
                    <div class="metric-icon">‚è±Ô∏è</div>
                    <div class="metric-value">{{TOTAL_DURATION}}</div>
                    <div class="metric-label">Total Duration</div>
                    <div class="metric-trend">Avg: {{AVG_MODULE_TIME}}</div>
                </div>

                <div class="metric-box">
                    <div class="metric-icon">üóëÔ∏è</div>
                    <div class="metric-value">{{BLOATWARE_REMOVED}}</div>
                    <div class="metric-label">Bloatware Removed</div>
                    <div class="metric-trend positive">{{BLOATWARE_DETECTED}} found</div>
                </div>

                <div class="metric-box">
                    <div class="metric-icon">üì¶</div>
                    <div class="metric-value">{{ESSENTIAL_INSTALLED}}</div>
                    <div class="metric-label">Essential Apps Installed</div>
                    <div class="metric-trend">{{ESSENTIAL_MISSING}} missing</div>
                </div>

                <div class="metric-box">
                    <div class="metric-icon">‚ö°</div>
                    <div class="metric-value">{{OPTIMIZATIONS_APPLIED}}</div>
                    <div class="metric-label">Optimizations Applied</div>
                    <div class="metric-trend positive">{{REGISTRY_CHANGES}} changes</div>
                </div>

                <div class="metric-box">
                    <div class="metric-icon">üéØ</div>
                    <div class="metric-value">{{SUCCESS_RATE}}%</div>
                    <div class="metric-label">Success Rate</div>
                    <div class="metric-trend positive">High Performance ‚ú®</div>
                </div>
            </div>

            <!-- Progress Bars -->
            <div class="progress-section">
                <div class="progress-item">
                    <div class="progress-header">
                        <span class="progress-title">Task Completion Progress</span>
                        <span class="progress-percent">{{TASKS_COMPLETED}}/{{TOTAL_TASKS}}</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" style="width: calc({{TASKS_COMPLETED}} / {{TOTAL_TASKS}} * 100%);"></div>
                    </div>
                </div>

                <div class="progress-item">
                    <div class="progress-header">
                        <span class="progress-title">System Health Score</span>
                        <span class="progress-percent">{{SYSTEM_HEALTH_SCORE}}%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar health" style="width: {{SYSTEM_HEALTH_SCORE}}%;"></div>
                    </div>
                </div>

                <div class="progress-item">
                    <div class="progress-header">
                        <span class="progress-title">Success Rate</span>
                        <span class="progress-percent">{{SUCCESS_RATE}}%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar success" style="width: {{SUCCESS_RATE}}%;"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Module Reports Section -->
        <section id="modules-section" class="modules-section">
            <h2 class="section-title">üîß Detailed Module Reports</h2>
            <div class="modules-container">
                {{MODULE_REPORTS}}
            </div>
        </section>

        <!-- Execution Timeline -->
        <section id="timeline-section" class="timeline-section">
            <details class="collapsible-card" open>
                <summary class="collapsible-header">
                    <span class="icon" aria-hidden="true">üìÖ</span>
                    <span class="title">Execution Timeline</span>
                    <span class="toggle-indicator" aria-hidden="true">‚ñº</span>
                </summary>
                <div class="collapsible-content">
                    <div class="timeline-content">
                        {{EXECUTION_TIMELINE}}
                    </div>
                </div>
            </details>
        </section>

        <!-- Detailed Logs -->
        <section id="logs-section" class="logs-section">
            <details class="collapsible-card" open>
                <summary class="collapsible-header">
                    <span class="icon" aria-hidden="true">üìù</span>
                    <span class="title">Detailed Execution Logs</span>
                    <span class="toggle-indicator" aria-hidden="true">‚ñº</span>
                </summary>
                <div class="collapsible-content">
                    <div class="log-viewer">
                        <div class="log-header">
                            <div class="log-title">
                                <span aria-hidden="true">üìã</span> Module Execution Logs
                            </div>
                            <div class="log-filters" role="group" aria-label="Filter logs by level">
                                <button class="log-filter-btn active" onclick="filterLogs('all')" aria-pressed="true">All</button>
                                <button class="log-filter-btn" onclick="filterLogs('error')" aria-pressed="false">Errors</button>
                                <button class="log-filter-btn" onclick="filterLogs('warning')" aria-pressed="false">Warnings</button>
                                <button class="log-filter-btn" onclick="filterLogs('success')" aria-pressed="false">Success</button>
                                <button class="log-filter-btn" onclick="filterLogs('info')" aria-pressed="false">Info</button>
                            </div>
                        </div>
                        <div class="log-entries" id="logEntries" role="log">
                            {{DETAILED_LOGS}}
                        </div>
                    </div>
                </div>
            </details>
        </section>

        <!-- Action Items -->
        <section id="actions-section" class="actions-section">
            <details class="collapsible-card" open>
                <summary class="collapsible-header">
                    <span class="icon" aria-hidden="true">‚úÖ</span>
                    <span class="title">Recommended Action Items</span>
                    <span class="toggle-indicator" aria-hidden="true">‚ñº</span>
                </summary>
                <div class="collapsible-content">
                    <div class="actions-list">
                        {{ACTION_ITEMS}}
                    </div>
                </div>
            </details>
        </section>

        <!-- System Information -->
        <section id="system-section" class="card card-secondary">
            <header class="card-header">
                <h2>üíª System Information</h2>
            </header>
            <div class="card-body">
                <div class="system-info-grid">
                    <!-- Hardware Column -->
                    <article class="system-info-box">
                        <h3>üñ•Ô∏è Hardware Configuration</h3>
                        <dl class="info-list">
                            <dt>Processor</dt>
                            <dd>{{PROCESSOR_NAME}}</dd>
                            
                            <dt>Memory</dt>
                            <dd>{{TOTAL_MEMORY}} GB</dd>
                            
                            <dt>Storage</dt>
                            <dd>{{STORAGE_INFO}}</dd>
                            
                            <dt>System Type</dt>
                            <dd>{{SYSTEM_TYPE}}</dd>
                        </dl>
                    </article>

                    <!-- OS Column -->
                    <article class="system-info-box">
                        <h3>üñ®Ô∏è Operating System</h3>
                        <dl class="info-list">
                            <dt>OS Version</dt>
                            <dd>{{OS_VERSION_DETAILED}}</dd>
                            
                            <dt>Build Number</dt>
                            <dd>{{BUILD_NUMBER}}</dd>
                            
                            <dt>Last Boot</dt>
                            <dd>{{LAST_BOOT_TIME}}</dd>
                            
                            <dt>Uptime</dt>
                            <dd>{{UPTIME_DURATION}}</dd>
                        </dl>
                    </article>

                    <!-- Network Column -->
                    <article class="system-info-box">
                        <h3>üåê Network Information</h3>
                        <dl class="info-list">
                            <dt>Computer Name</dt>
                            <dd>{{COMPUTER_NAME}}</dd>
                            
                            <dt>Domain</dt>
                            <dd>{{DOMAIN_NAME}}</dd>
                            
                            <dt>Network Adapters</dt>
                            <dd>{{NETWORK_ADAPTERS}}</dd>
                            
                            <dt>IPv4 Address</dt>
                            <dd>{{IPV4_ADDRESS}}</dd>
                        </dl>
                    </article>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="report-footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>About This Report</h4>
                    <p>This comprehensive report contains detailed information about system maintenance operations, optimizations applied, and recommendations for further improvements.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="#executive-summary">Executive Summary</a></li>
                        <li><a href="#metrics-section">Metrics</a></li>
                        <li><a href="#modules-section">Modules</a></li>
                        <li><a href="#system-section">System Info</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Report Details</h4>
                    <ul class="footer-info">
                        <li><strong>Generated:</strong> {{GENERATION_TIME}}</li>
                        <li><strong>System:</strong> {{COMPUTER_NAME}}</li>
                        <li><strong>Version:</strong> 3.0</li>
                        <li><strong>Tool:</strong> Windows Maintenance Automation</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>üìÑ Windows Maintenance Report v3.0 | Generated by Windows Maintenance Automation</p>
                <p style="font-size: 0.9em; opacity: 0.7;">‚ö° Advanced system analysis and optimization suite</p>
            </div>
        </footer>
    </main>

    <!-- Scripts -->
    <script>
        // Dark Mode Toggle
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            const toggle = document.getElementById('themeToggle');
            const icon = document.getElementById('themeIcon');
            const text = document.getElementById('themeText');
            
            if (newTheme === 'dark') {
                icon.textContent = '‚òÄÔ∏è';
                text.textContent = 'Light Mode';
                toggle.setAttribute('aria-pressed', 'true');
            } else {
                icon.textContent = 'üåô';
                text.textContent = 'Dark Mode';
                toggle.setAttribute('aria-pressed', 'false');
            }
        }

        // Load saved theme
        window.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            if (savedTheme === 'dark') {
                document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';
                document.getElementById('themeText').textContent = 'Light Mode';
                document.getElementById('themeToggle').setAttribute('aria-pressed', 'true');
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl+Shift+D for theme toggle
            if (e.ctrlKey && e.shiftKey && e.key === 'D') {
                e.preventDefault();
                toggleTheme();
            }
            // Home key to scroll to top
            if (e.key === 'Home') {
                e.preventDefault();
                scrollToTop();
            }
        });

        // Log Filtering
        function filterLogs(level) {
            const entries = document.querySelectorAll('.log-entry');
            const buttons = document.querySelectorAll('.log-filter-btn');
            
            // Update active button
            buttons.forEach(btn => {
                btn.classList.remove('active');
                btn.setAttribute('aria-pressed', 'false');
            });
            event.target.classList.add('active');
            event.target.setAttribute('aria-pressed', 'true');
            
            // Filter entries
            entries.forEach(entry => {
                if (level === 'all' || entry.classList.contains(level)) {
                    entry.style.display = 'flex';
                } else {
                    entry.style.display = 'none';
                }
            });
        }

        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Scroll to top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Print functionality
        function printReport() {
            window.print();
        }

        // Export to PDF
        function exportToPDF() {
            window.print();
            // Note: Users should select "Save as PDF" in the print dialog
        }

        // Enhanced details/summary keyboard support
        document.querySelectorAll('details').forEach(details => {
            const summary = details.querySelector('summary');
            if (summary) {
                summary.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        details.open = !details.open;
                    }
                });
            }
        });
    </script>
</body>
</html>
