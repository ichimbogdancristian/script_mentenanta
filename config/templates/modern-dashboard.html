<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{REPORT_TITLE}} - System Maintenance Report</title>
    <link rel="stylesheet" href="modern-dashboard.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* Embedded critical CSS for immediate load */
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
        .loading { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 1.2rem; color: #8b949e;
        }
    </style>
</head>
<body>
    <!-- Loading State -->
    <div class="loading" id="loadingState">
        <div style="text-align: center;">
            <div style="margin-bottom: 1rem;">‚ö° Loading System Report...</div>
            <div style="font-size: 0.875rem; opacity: 0.7;">Analyzing maintenance data</div>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div class="dashboard fade-in" id="mainDashboard" style="display: none;">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="dashboard-title">
                <div>
                    <h1>üõ†Ô∏è {{COMPUTER_NAME}} System Maintenance</h1>
                    <div class="dashboard-subtitle">
                        Generated on {{GENERATION_DATE}} | Session: {{SESSION_ID}} | v{{VERSION}}
                    </div>
                </div>
                <div class="dashboard-controls">
                    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle Theme">
                        <span id="themeIcon">üåô</span>
                    </button>
                    <button class="quick-action" onclick="window.print()" title="Print Report">
                        üñ®Ô∏è Print
                    </button>
                    <button class="quick-action" onclick="exportData()" title="Export Data">
                        üìä Export
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="dashboard-main">
            <!-- Executive Summary -->
            <section class="grid grid-4" id="summaryCards">
                <div class="card status-card status-{{OVERALL_STATUS_CLASS}} slide-up">
                    <div class="card-header">
                        <div class="card-icon">üè•</div>
                        <div class="module-status {{OVERALL_STATUS_CLASS}}"></div>
                    </div>
                    <div class="status-value">{{OVERALL_HEALTH_SCORE}}%</div>
                    <div class="status-label">System Health</div>
                    <div class="card-subtitle">{{OVERALL_STATUS_TEXT}}</div>
                </div>

                <div class="card status-card status-{{SECURITY_STATUS_CLASS}} slide-up">
                    <div class="card-header">
                        <div class="card-icon">üîê</div>
                        <div class="module-status {{SECURITY_STATUS_CLASS}}"></div>
                    </div>
                    <div class="status-value">{{SECURITY_SCORE}}%</div>
                    <div class="status-label">Security Score</div>
                    <div class="card-subtitle">{{SECURITY_STATUS_TEXT}}</div>
                </div>

                <div class="card status-card status-{{PERFORMANCE_STATUS_CLASS}} slide-up">
                    <div class="card-header">
                        <div class="card-icon">‚ö°</div>
                        <div class="module-status {{PERFORMANCE_STATUS_CLASS}}"></div>
                    </div>
                    <div class="status-value">{{ITEMS_PROCESSED}}</div>
                    <div class="status-label">Items Processed</div>
                    <div class="card-subtitle">{{EXECUTION_DURATION}} execution time</div>
                </div>

                <div class="card status-card status-{{ERRORS_STATUS_CLASS}} slide-up">
                    <div class="card-header">
                        <div class="card-icon">‚ö†Ô∏è</div>
                        <div class="module-status {{ERRORS_STATUS_CLASS}}"></div>
                    </div>
                    <div class="status-value">{{TOTAL_ERRORS}}</div>
                    <div class="status-label">Issues Found</div>
                    <div class="card-subtitle">{{ERROR_STATUS_TEXT}}</div>
                </div>
            </section>

            <!-- System Information -->
            <section class="system-info-grid">
                <div class="card system-info-card scale-in">
                    <div class="card-header">
                        <h3 class="card-title">üíª System Information</h3>
                        <div class="card-icon">üñ•Ô∏è</div>
                    </div>
                    <div class="card-content">
                        <span class="system-info-label">Computer Name:</span>
                        <span class="system-info-value">{{COMPUTER_NAME}}</span>
                        
                        <span class="system-info-label">Operating System:</span>
                        <span class="system-info-value">{{OS_NAME}} {{OS_VERSION}}</span>
                        
                        <span class="system-info-label">Architecture:</span>
                        <span class="system-info-value">{{OS_ARCHITECTURE}}</span>
                        
                        <span class="system-info-label">Last Boot:</span>
                        <span class="system-info-value">{{LAST_BOOT_TIME}}</span>
                        
                        <span class="system-info-label">Uptime:</span>
                        <span class="system-info-value">{{SYSTEM_UPTIME}}</span>
                        
                        <span class="system-info-label">User:</span>
                        <span class="system-info-value">{{CURRENT_USER}}</span>
                    </div>
                </div>

                <div class="card system-info-card scale-in">
                    <div class="card-header">
                        <h3 class="card-title">üîß Hardware Overview</h3>
                        <div class="card-icon">‚öôÔ∏è</div>
                    </div>
                    <div class="card-content">
                        <span class="system-info-label">Processor:</span>
                        <span class="system-info-value">{{CPU_NAME}}</span>
                        
                        <span class="system-info-label">Cores:</span>
                        <span class="system-info-value">{{CPU_CORES}} cores ({{CPU_LOGICAL_CORES}} logical)</span>
                        
                        <span class="system-info-label">Total Memory:</span>
                        <span class="system-info-value">{{TOTAL_MEMORY_GB}} GB</span>
                        
                        <span class="system-info-label">Available Memory:</span>
                        <span class="system-info-value">{{AVAILABLE_MEMORY_GB}} GB</span>
                        
                        <span class="system-info-label">Memory Usage:</span>
                        <div class="progress-bar" style="grid-column: 2;">
                            <div class="progress-fill {{MEMORY_STATUS_CLASS}}" style="width: {{MEMORY_USAGE_PERCENT}}%"></div>
                        </div>
                    </div>
                </div>

                <div class="card system-info-card scale-in">
                    <div class="card-header">
                        <h3 class="card-title">üíæ Storage Overview</h3>
                        <div class="card-icon">üóÇÔ∏è</div>
                    </div>
                    <div class="card-content">
                        <span class="system-info-label">System Drive:</span>
                        <span class="system-info-value">{{SYSTEM_DRIVE}}</span>
                        
                        <span class="system-info-label">Total Space:</span>
                        <span class="system-info-value">{{SYSTEM_DRIVE_TOTAL_GB}} GB</span>
                        
                        <span class="system-info-label">Free Space:</span>
                        <span class="system-info-value">{{SYSTEM_DRIVE_FREE_GB}} GB</span>
                        
                        <span class="system-info-label">Usage:</span>
                        <div class="progress-bar" style="grid-column: 2;">
                            <div class="progress-fill {{DISK_STATUS_CLASS}}" style="width: {{DISK_USAGE_PERCENT}}%"></div>
                        </div>
                        
                        <span class="system-info-label">File System:</span>
                        <span class="system-info-value">{{SYSTEM_DRIVE_FILESYSTEM}}</span>
                        
                        <span class="system-info-label">Status:</span>
                        <span class="system-info-value">{{DISK_HEALTH_STATUS}}</span>
                    </div>
                </div>

                <div class="card system-info-card scale-in">
                    <div class="card-header">
                        <h3 class="card-title">üåê Network & Connectivity</h3>
                        <div class="card-icon">üì°</div>
                    </div>
                    <div class="card-content">
                        <span class="system-info-label">Network Status:</span>
                        <span class="system-info-value">{{NETWORK_STATUS}}</span>
                        
                        <span class="system-info-label">Primary Adapter:</span>
                        <span class="system-info-value">{{PRIMARY_NETWORK_ADAPTER}}</span>
                        
                        <span class="system-info-label">IP Address:</span>
                        <span class="system-info-value">{{PRIMARY_IP_ADDRESS}}</span>
                        
                        <span class="system-info-label">DNS Servers:</span>
                        <span class="system-info-value">{{DNS_SERVERS}}</span>
                        
                        <span class="system-info-label">Domain:</span>
                        <span class="system-info-value">{{DOMAIN_STATUS}}</span>
                        
                        <span class="system-info-label">Firewall:</span>
                        <span class="system-info-value">{{FIREWALL_STATUS}}</span>
                    </div>
                </div>
            </section>

            <!-- Module Results -->
            <section class="grid grid-2" id="moduleResults">
                {{MODULE_CARDS}}
            </section>

            <!-- Execution Summary -->
            <section class="grid grid-2">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üìã Execution Summary</h3>
                        <div class="card-icon">üìä</div>
                    </div>
                    <div class="card-content">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Module</th>
                                    <th>Status</th>
                                    <th>Items</th>
                                    <th>Duration</th>
                                </tr>
                            </thead>
                            <tbody>
                                {{EXECUTION_SUMMARY_ROWS}}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üîç System Changes</h3>
                        <div class="card-icon">üìù</div>
                    </div>
                    <div class="card-content">
                        <div class="log-viewer">
                            <div class="log-header">
                                <div class="log-title">Recent Modifications</div>
                                <div class="log-controls">
                                    <button class="log-control" onclick="filterLogs('all')">All</button>
                                    <button class="log-control" onclick="filterLogs('success')">Success</button>
                                    <button class="log-control" onclick="filterLogs('warning')">Warnings</button>
                                    <button class="log-control" onclick="filterLogs('error')">Errors</button>
                                </div>
                            </div>
                            <div class="log-content" id="systemChangesLog">
                                {{SYSTEM_CHANGES_LOG}}
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Quick Actions -->
            <section class="card">
                <div class="card-header">
                    <h3 class="card-title">üöÄ Quick Actions & Recommendations</h3>
                    <div class="card-icon">‚ö°</div>
                </div>
                <div class="card-content">
                    <div class="quick-actions">
                        <a href="#" class="quick-action" onclick="runQuickMaintenance()">
                            üîÑ Run Quick Maintenance
                        </a>
                        <a href="#" class="quick-action" onclick="scheduleNextRun()">
                            üìÖ Schedule Next Run
                        </a>
                        <a href="#" class="quick-action" onclick="viewFullLogs()">
                            üìÑ View Full Logs
                        </a>
                        <a href="#" class="quick-action" onclick="exportSettings()">
                            ‚öôÔ∏è Export Settings
                        </a>
                        <a href="#" class="quick-action" onclick="createSystemRestore()">
                            üíæ Create Restore Point
                        </a>
                        <a href="#" class="quick-action" onclick="downloadReport()">
                            üì• Download Report
                        </a>
                    </div>
                    <div style="margin-top: var(--spacing-lg); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-secondary);">
                        <h4 style="color: var(--text-primary); margin-bottom: var(--spacing-md);">üí° Recommendations</h4>
                        <div id="recommendations">
                            {{RECOMMENDATIONS}}
                        </div>
                    </div>
                </div>
            </section>

            <!-- Footer -->
            <footer class="card" style="text-align: center; margin-top: var(--spacing-2xl);">
                <div class="card-content" style="color: var(--text-muted); font-size: var(--font-size-sm);">
                    <p>Generated by <strong>Windows Maintenance Orchestrator v{{VERSION}}</strong></p>
                    <p>Report generated at {{GENERATION_TIMESTAMP}} | Total execution time: {{TOTAL_EXECUTION_TIME}}</p>
                    <p style="margin-top: var(--spacing-md);">
                        üîí This report contains system information for: <strong>{{COMPUTER_NAME}}</strong> 
                        | Session ID: <code>{{SESSION_ID}}</code>
                    </p>
                </div>
            </footer>
        </main>
    </div>

    <!-- Embedded JavaScript -->
    <script>
        // Theme Management
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            document.getElementById('themeIcon').textContent = newTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
            
            // Save preference
            localStorage.setItem('theme', newTheme);
        }

        // Load saved theme
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('themeIcon').textContent = savedTheme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
        }

        // Log Filtering
        function filterLogs(level) {
            const logEntries = document.querySelectorAll('.log-entry');
            logEntries.forEach(entry => {
                if (level === 'all' || entry.classList.contains(level)) {
                    entry.style.display = '';
                } else {
                    entry.style.display = 'none';
                }
            });
            
            // Update active button
            document.querySelectorAll('.log-control').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Quick Actions
        function runQuickMaintenance() {
            alert('This would launch a quick maintenance routine.\n\nIn a real implementation, this could:\n‚Ä¢ Clear temporary files\n‚Ä¢ Check for updates\n‚Ä¢ Run quick system scans');
        }

        function scheduleNextRun() {
            const nextRun = new Date();
            nextRun.setDate(nextRun.getDate() + 7);
            alert(`Next maintenance run scheduled for:\n${nextRun.toLocaleDateString()} at ${nextRun.toLocaleTimeString()}`);
        }

        function viewFullLogs() {
            const logWindow = window.open('', 'logs', 'width=800,height=600');
            logWindow.document.write(`
                <html>
                <head><title>Full Maintenance Logs</title></head>
                <body style="font-family: monospace; padding: 20px; background: #0d1117; color: #f0f6fc;">
                <h2>üîç Full Maintenance Logs</h2>
                <pre style="white-space: pre-wrap; background: #161b22; padding: 20px; border-radius: 8px;">
{{FULL_LOGS}}
                </pre>
                </body>
                </html>
            `);
        }

        function exportSettings() {
            const settings = {
                computerName: '{{COMPUTER_NAME}}',
                sessionId: '{{SESSION_ID}}',
                reportDate: '{{GENERATION_DATE}}',
                moduleResults: 'Extracted module configuration...'
            };
            
            const dataStr = JSON.stringify(settings, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `maintenance-settings-{{COMPUTER_NAME}}-{{SESSION_ID}}.json`;
            link.click();
        }

        function createSystemRestore() {
            alert('This would create a system restore point.\n\nIn a real implementation, this would:\n‚Ä¢ Create a Windows System Restore point\n‚Ä¢ Backup current system settings\n‚Ä¢ Enable quick rollback if needed');
        }

        function downloadReport() {
            // Create a downloadable version of the report
            const reportHtml = document.documentElement.outerHTML;
            const blob = new Blob([reportHtml], {type: 'text/html'});
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `system-maintenance-report-{{COMPUTER_NAME}}-{{SESSION_ID}}.html`;
            link.click();
        }

        function exportData() {
            const data = {
                metadata: {
                    computerName: '{{COMPUTER_NAME}}',
                    reportDate: '{{GENERATION_DATE}}',
                    sessionId: '{{SESSION_ID}}',
                    version: '{{VERSION}}'
                },
                systemInfo: {
                    os: '{{OS_NAME}} {{OS_VERSION}}',
                    uptime: '{{SYSTEM_UPTIME}}',
                    memory: '{{TOTAL_MEMORY_GB}} GB',
                    disk: '{{SYSTEM_DRIVE_TOTAL_GB}} GB'
                },
                summary: {
                    healthScore: '{{OVERALL_HEALTH_SCORE}}%',
                    securityScore: '{{SECURITY_SCORE}}%',
                    itemsProcessed: '{{ITEMS_PROCESSED}}',
                    totalErrors: '{{TOTAL_ERRORS}}'
                }
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `system-report-data-{{SESSION_ID}}.json`;
            link.click();
        }

        // Smooth loading animation
        function initDashboard() {
            setTimeout(() => {
                document.getElementById('loadingState').style.display = 'none';
                document.getElementById('mainDashboard').style.display = 'block';
                
                // Animate cards in sequence
                const cards = document.querySelectorAll('.slide-up, .scale-in');
                cards.forEach((card, index) => {
                    setTimeout(() => {
                        card.style.animationDelay = `${index * 0.1}s`;
                    }, index * 100);
                });
            }, 1000);
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initTheme();
            initDashboard();
            
            // Add some interactive effects
            document.querySelectorAll('.card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.boxShadow = 'var(--shadow-xl)';
                });
                card.addEventListener('mouseleave', function() {
                    this.style.boxShadow = '';
                });
            });
        });
    </script>
</body>
</html>